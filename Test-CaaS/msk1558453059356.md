<html><head></head><body><div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="afk1507830462798" id="afk1507830462798"><h1 class="title topictitle1" id="ariaid-title1">Pivoting (ML Engine)</h1><div class="body conbody">
<p class="p">The Pivoting function pivots data that is stored in rows into columns. It outputs a table whose columns are based on the individual values from an input table column. The output table schema depends on the function syntax elements. The function handles missing or NULL values automatically.</p>
<p class="p">The reverse of this function is <a href="mgx1558453229425.md#yna1507821764200">Unpivoting (ML Engine)</a>.</p></div><div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="ytw1507830537293" xml:lang="en-us" lang="en-us" id="ytw1507830537293">
<h2 class="title topictitle2" id="ariaid-title2">Pivoting Syntax</h2><div class="body refbody"><div class="section" id="ytw1507830537293__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">Version <span>1.8</span></h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM Pivoting (
  <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> PARTITION BY <var class="keyword varname">partition_column</var> [,...]
  [ ORDER BY <var class="keyword varname">order_column</var> ]
  USING
  PartitionColumns ({ '<var class="keyword varname">partition_column</var>' | <var class="keyword varname">partition_column_range</var> }[,...])
  { NumberOfRows (<var class="keyword varname">number_of_rows</var>) |
    PivotColumn ('<var class="keyword varname">pivot_column</var>')
    [ PivotKeys ('<var class="keyword varname">pivot_key</var>' [,...]) ]
    [ NumericPivotKey (<span><b>{'true'|'t'|'yes'|'y'|'1'|'false'|'f'|'no'|'n'|'0'}</b></span>) ]
  }
  TargetColumns ({ '<var class="keyword varname">target_column</var>' | '<var class="keyword varname">target_column_range</var>' }[,...])
) AS <var class="keyword varname">alias</var>;</code></pre></div></div><div class="related-links"><div class="linklistheader"><p></p><b>Related Information</b></div>
<ul class="linklist linklist relinfo"><div class="linklistmember"><a href="ndv1557782188375.md">Column Specification Syntax Elements</a></div></ul></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="nbu1507830542133" xml:lang="en-us" lang="en-us" id="nbu1507830542133">
<h2 class="title topictitle2" id="ariaid-title3">Pivoting Syntax Elements</h2><div class="body refbody"><div class="section" id="nbu1507830542133__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">PartitionColumns</dt><dd class="dd pd">Specify the same columns as the PARTITION BY clause (in any order).</dd><dt class="dt pt dlterm">NumberOfRows</dt><dd class="dd pd">[Required if you omit PivotColumn.] Use NumberOfRows when no column contains pivot keys, but you can specify a maximum number of rows in any partition. The function pivots the input rows into this number of columns in the output table.
<p class="p">If a partition has fewer than <var class="keyword varname">number_of_rows</var> rows, the function adds NULL values; if a partition has more than <var class="keyword varname">number_of_rows</var> rows, the function omits the extra rows.</p>
<p class="p">If you use NumberOfRows, you must use the ORDER BY clause to order the input data; otherwise, the contents of the output table columns may vary from run to run.</p></dd><dt class="dt pt dlterm">PivotColumn</dt><dd class="dd pd">[Required if you omit NumberOfRows.] Specify the name of the input column that contains the pivot keys.
<p class="p">If <var class="keyword varname">pivot_column</var> contains numeric values, the function casts them to VARCHAR; function performance improves slightly if you specify NumericPivotKey ('true').</p></dd><dt class="dt pt dlterm">PivotKeys</dt><dd class="dd pd">[Required if you specify PivotColumn.] Specify the values in <var class="keyword varname">pivot_column</var> to use as pivot keys. The function ignores rows that contain other values in <var class="keyword varname">pivot_column</var>.</dd><dt class="dt pt dlterm">NumericPivotKey</dt><dd class="dd pd">[Optional] Use this syntax element only with the PivotColumn syntax element. If <var class="keyword varname">pivot_column</var> is numeric, NumericPivotKey ('true') improves function performance slightly.</dd><dd class="dd pd ddexpand">Default: 'false'</dd><dt class="dt pt dlterm">TargetColumns</dt><dd class="dd pd">[Optional] Specify the names of the target columns (input columns that contain the values to pivot).</dd></dl></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="yee1507830546124" xml:lang="en-us" lang="en-us" id="yee1507830546124">
<h2 class="title topictitle2" id="ariaid-title4">Pivoting Input</h2><div class="body refbody"><div class="section" id="yee1507830546124__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">Input Table Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="yee1507830546124__table_N10014_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:18.181818181818183%" span="1"></col><col style="width:9.090909090909092%" span="1"></col><col style="width:72.72727272727273%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d37421e232" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d37421e234" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d37421e236" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d37421e232" rowspan="1" colspan="1"><var class="keyword varname">partition_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d37421e234" rowspan="1" colspan="1">Any</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d37421e236" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">partition_column</var>.] Column by which to partition input data.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d37421e232" rowspan="1" colspan="1"><var class="keyword varname">target_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d37421e234" rowspan="1" colspan="1">Any</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e236" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">target_column</var>.] Values to pivot.</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="ozq1507830554815" xml:lang="en-us" lang="en-us" id="ozq1507830554815">
<h2 class="title topictitle2" id="ariaid-title5">Pivoting Output</h2><div class="body refbody"><div class="section" id="ozq1507830554815__section_irx_xls_ycb">
<p class="p">The output table schema depends on whether you specify the syntax element NumberOfRows or PivotColumn.</p></div><div class="section" id="ozq1507830554815__section_zdq_tls_ycb">
<h3 class="title sectiontitle">Output Table Schema, NumberOfRows</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ozq1507830554815__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:22.22222222222222%" span="1"></col><col style="width:11.11111111111111%" span="1"></col><col style="width:66.66666666666666%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d37421e283" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d37421e285" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d37421e287" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d37421e283" rowspan="1" colspan="1"><var class="keyword varname">partition_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d37421e285" rowspan="1" colspan="1"><span>Same as in Input table</span></td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d37421e287" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">partition_column</var>.] Column by which input data is partitioned.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d37421e283" rowspan="1" colspan="1">value_<var class="keyword varname">i</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d37421e285" rowspan="1" colspan="1">Any</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e287" rowspan="1" colspan="1">[Column appears <var class="keyword varname">number_of_rows</var> times.] Value in <var class="keyword varname">i</var>th target column, where <var class="keyword varname">i</var> is in range [0, <var class="keyword varname">number_of_rows</var>-1]. Columns appear in order specified by ORDER BY clause.</td></tr></tbody></table></div></div><div class="section" id="ozq1507830554815__section_hcm_vls_ycb">
<h3 class="title sectiontitle">Output Table Schema, PivotColumn</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ozq1507830554815__table_zpv_3c2_ny" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:22.22222222222222%" span="1"></col><col style="width:11.11111111111111%" span="1"></col><col style="width:66.66666666666666%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d37421e333" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d37421e335" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d37421e337" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d37421e333" rowspan="1" colspan="1"><var class="keyword varname">partition_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d37421e335" rowspan="1" colspan="1">Any</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d37421e337" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">partition_column</var>.] Column by which input data is partitioned.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d37421e333" rowspan="1" colspan="1">value_<var class="keyword varname">target_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d37421e335" rowspan="1" colspan="1">Any</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e337" rowspan="1" colspan="1">[Column appears once for each <var class="keyword varname">pivot_key</var>.] Values for <var class="keyword varname">pivot_key</var> that are associated with partitions in row.</td></tr></tbody></table></div></div></div></div><div class="topic concept nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="sjk1510711610951" xml:lang="en-us" lang="en-us" id="sjk1510711610951">
<h2 class="title topictitle2" id="ariaid-title6">Pivoting Examples</h2><div class="topic reference nested2" aria-labelledby="ariaid-title7" topicindex="7" topicid="zkq1507830593775" xml:lang="en-us" lang="en-us" id="zkq1507830593775">
<h3 class="title topictitle3" id="ariaid-title7">Pivoting Example: <span>PivotKeys</span></h3><div class="body refbody"><div class="section" id="zkq1507830593775__section_N10011_N1000E_N10001">
<p class="p">This example specifies the <span>PivotColumn</span> syntax element and, with the PivotKeys syntax element, the values from the pivot column to use as pivot keys. Because PivotKeys does not include 'dewpoint', the function ignores rows that include 'dewpoint'.</p></div><div class="section" id="zkq1507830593775__section_i3w_1wr_t2b">
<h4 class="title sectiontitle">Input</h4>
<p class="p">The input table, pivot_input, contains temperature, pressure, and dewpoint data for three cities, in sparse format.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="zkq1507830593775__table_udj_zh3_jfb" class="table" frame="border" border="1" rules="all"><div class="caption"><span>pivot_input</span></div><colgroup span="1"><col style="width:20%" span="1"></col><col style="width:20%" span="1"></col><col style="width:20%" span="1"></col><col style="width:20%" span="1"></col><col style="width:20%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d37421e424" rowspan="1" colspan="1">sn</th><th class="entry cellrowborder" style="vertical-align:top;" id="d37421e426" rowspan="1" colspan="1">city</th><th class="entry cellrowborder" style="vertical-align:top;" id="d37421e428" rowspan="1" colspan="1">week</th><th class="entry cellrowborder" style="vertical-align:top;" id="d37421e430" rowspan="1" colspan="1">attribute</th><th class="entry cellrowborder" style="vertical-align:top;" id="d37421e432" rowspan="1" colspan="1"><span>value</span></th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Asheville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">temp</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">32</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Asheville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">pressure</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">1020.8</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Asheville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">dewpoint</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">27.6F</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Asheville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">temp</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">32</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Asheville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">pressure</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">1021.3</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Asheville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">dewpoint</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">27.4F</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Asheville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">temp</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">34</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Asheville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">pressure</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">1021.7</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Asheville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">dewpoint</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">28.2F</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Nashville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">temp</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">42</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Nashville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">pressure</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">1021</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Nashville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">dewpoint</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">29.4F</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">5</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Nashville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">temp</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">44</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">5</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Nashville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">pressure</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">1019.8</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">5</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Nashville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">dewpoint</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">29.2F</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">6</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Brownsville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">temp</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">47</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">6</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Brownsville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">pressure</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">1019</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">6</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Brownsville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">dewpoint</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">28.9F</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">7</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Brownsville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">temp</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">46</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">7</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Brownsville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">pressure</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">1019.2</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e424" rowspan="1" colspan="1">7</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e426" rowspan="1" colspan="1">Brownsville</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e428" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e430" rowspan="1" colspan="1">dewpoint</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d37421e432" rowspan="1" colspan="1">28.9F</td></tr></tbody></table></div></div><div class="section" id="zkq1507830593775__section_xmg_ttn_xdb">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM Pivoting (
  ON pivot_input PARTITION BY sn,city,week
  ORDER BY week,attribute
  USING
  PartitionColumns ('sn','city', 'week')
  NumberOfRows (3)
  TargetColumns ('value1')
) AS dt ORDER BY 1,2,3;</code></pre>
<p class="p">The ORDER BY clause is required. If omitted, the output table column content is nondeterministic (for more information, see <a href="qym1549987102806.md">Nondeterministic Results and UniqueID Syntax Element</a>).</p></div><div class="section" id="zkq1507830593775__section_epw_ttn_xdb">
<h4 class="title sectiontitle">Output</h4>
<p class="p">The function outputs the input column contents in dense format in the output columns value_temp and value_pressure, which contain the temperature and pressure, respectively. Because these values are numeric, the function casts them to VARCHAR.</p><pre class="pre screen" xml:space="preserve"> sn city        week value1_0 value1_1 value1_2 
 -- ----------- ---- -------- -------- -------- 
  1 asheville      1 27.6f    1020.8   32      
  2 asheville      2 27.4f    1021.3   32      
  3 asheville      3 28.2f    1021.7   34      
  4 nashville      1 29.4f    1021     42      
  5 nashville      2 29.2f    1019.8   44      
  6 brownsville    2 28.9f    1019     47      
  7 brownsville    3 28.9f    1019.2   46</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div><div class="topic reference nested2" aria-labelledby="ariaid-title8" topicindex="8" topicid="upi1507830608678" xml:lang="en-us" lang="en-us" id="upi1507830608678">
<h3 class="title topictitle3" id="ariaid-title8">Pivoting Example: <span>NumberOfRows</span></h3><div class="body refbody"><div class="section" id="upi1507830608678__section_N10011_N1000E_N10001">
<h4 class="title sectiontitle">Input</h4>
<ul class="ul" id="upi1507830608678__ul_zhz_vvr_t2b">
<li class="li">Input table: pivot_input, as in <a href="msk1558453059356.md#zkq1507830593775">Pivoting Example: PivotKeys</a></li></ul></div><div class="section" id="upi1507830608678__section_xmg_ttn_xdb">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM Pivoting (
  ON pivot_input PARTITION BY sn,city,week
  ORDER BY week,attribute
  USING
  PartitionColumns ('sn','city', 'week')
  PivotKeys ('temp','pressure')
  PivotColumn ('attribute')
  TargetColumns ('value1')
) AS dt ORDER BY 1,2,3;</code></pre>
<p class="p">The ORDER BY clause is optional. If omitted, the order of values can vary. The function always adds any NULL values at the end.</p></div><div class="section" id="upi1507830608678__section_epw_ttn_xdb">
<h4 class="title sectiontitle">Output</h4>
<p class="p">To create the output table, the function pivots the input table on the partition columns (sn, city, and week) and outputs the contents of the target column (value) in dense format in the output columns value_0, value_1, and value_2, which contain the temperature, pressure, and dewpoint, respectively.</p><pre class="pre screen" xml:space="preserve"> sn city        week value1_pressure value1_temp 
 -- ----------- ---- --------------- ----------- 
  1 asheville      1 1020.8          32         
  2 asheville      2 1021.3          32         
  3 asheville      3 1021.7          34         
  4 nashville      1 1021            42         
  5 nashville      2 1019.8          44         
  6 brownsville    2 1019            47         
  7 brownsville    3 1019.2          46</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div></div></div></body></html>
