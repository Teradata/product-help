<html><head></head><body><div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="kgn1507909000942" id="kgn1507909000942"><h1 class="title topictitle1" id="ariaid-title1">WSRecommender</h1><div class="body conbody">
<p class="p">The WSRecommender function is an item-based, collaborative filtering
			function that uses a weighted-sum algorithm to make recommendations (for example, items
			or products for users to consider purchasing).</p><div class="fig fignone" id="kgn1507909000942__fig_uvq_1rd_pw"><div class="caption"></div><br clear="none"></br><img class="image" id="kgn1507909000942__image_dky_1rd_pw" src="klv1466005781269.svg" alt="How Machine Learning Engine function WSRecommender works"></img><br clear="none"></br></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="grt1507909037108" xml:lang="en-us" lang="en-us" id="grt1507909037108">
<h2 class="title topictitle2" id="ariaid-title2">WSRecommender Syntax</h2><div class="body refbody"><div class="section" id="grt1507909037108__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">WSRecommender version <span>1.2</span>, WSRecommenderReduce version <span>1.2</span></h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM WSRecommender
  ON (
    SELECT * FROM WSRecommenderReduce (
      ON <var class="keyword varname">item_table</var> AS ItemTable PARTITION BY <var class="keyword varname">item1_column</var> 
      ON <var class="keyword varname">user_table</var> AS UserTable PARTITION BY <var class="keyword varname">item_column</var>
      [ USING
        [ Item1 ('<var class="keyword varname">item1_column</var>') ]
        [ Item2 ('<var class="keyword varname">item2_column</var>') ]
        [ ItemSimilarityScore ('<var class="keyword varname">similarity_column</var>') ]
        [ UserItemColumn ('<var class="keyword varname">item_column</var>') ]
        [ UserIDColumn ('<var class="keyword varname">user_column</var>') ]
        [ UserPrefColumn ('<var class="keyword varname">preference_column</var>') ]
        [ AccumulateItem ({ '<var class="keyword varname">accumulate_item_column</var>' | <var class="keyword varname">accumulate_item_column_range</var> }[,...]) ]
        [ AccumulateUser ({ '<var class="keyword varname">accumulate_user_column</var>' | <var class="keyword varname">accumulate_user_column_range</var> }[,...]) ]
      ]
    ) AS <var class="keyword varname">alias_1</var>
  ) AS <var class="keyword varname">temporary_table</var> PARTITION BY <var class="keyword varname">usr</var>, <var class="keyword varname">col1_item2</var> 
) AS <var class="keyword varname">alias_2</var>;</code></pre></div></div><div class="related-links"><div class="linklistheader"><p></p><b>Related Information</b></div>
<ul class="linklist linklist relinfo"><div class="linklistmember"><a href="ndv1557782188375.md">Column Specification Syntax Elements</a></div></ul></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="wuh1507909040989" xml:lang="en-us" lang="en-us" id="wuh1507909040989">
<h2 class="title topictitle2" id="ariaid-title3">WSRecommender Syntax Elements</h2><div class="body refbody"><div class="section" id="wuh1507909040989__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">Item1</dt><dd class="dd pd">[Optional] Specify the name of the ItemTable column that contains the first item (item1).</dd><dd class="dd pd ddexpand">Default: 'col1_item1'</dd><dt class="dt pt dlterm">Item2</dt><dd class="dd pd">[Optional] Specify the name of the ItemTable column that contains the second item (item2).</dd><dd class="dd pd ddexpand">Default: 'col1_item2'</dd><dt class="dt pt dlterm">ItemSimilarityScore</dt><dd class="dd pd">[Optional] Specify the name of the ItemTable column that contains the similarity score for item1 and item2.</dd><dd class="dd pd ddexpand">Default: 'cntb'</dd><dt class="dt pt dlterm">UserItemColumn</dt><dd class="dd pd">[Optional] Specify the name of the UserTable column that contains the names of the items that the user viewed or purchased.</dd><dd class="dd pd ddexpand">Default: 'item'</dd><dt class="dt pt dlterm">UserIDColumn</dt><dd class="dd pd">Specify the name of the UserTable column that contains the unique user identifiers.</dd><dd class="dd pd ddexpand">Default: 'usr'</dd><dt class="dt pt dlterm">UserPrefColumn</dt><dd class="dd pd">[Optional] Specify the name of the UserTable column that contains user preferences for an item, expressed as numeric values. The value 0 indicates no preference.</dd><dd class="dd pd ddexpand">Default: 'preference'</dd><dt class="dt pt dlterm">AccumulateItem</dt><dd class="dd pd">[Optional] Specify the names of ItemTable columns to copy to the output table.</dd><dt class="dt pt dlterm">AccumulateUser</dt><dd class="dd pd">[Optional] Specify the names of UserTable columns to copy to the output table.</dd></dl></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="dob1507909044481" xml:lang="en-us" lang="en-us" id="dob1507909044481">
<h2 class="title topictitle2" id="ariaid-title4">WSRecommender Input</h2><div class="body refbody"><div class="section" id="dob1507909044481__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">ItemTable Schema</h3>
<p class="p">This table contains all pairs of items bought together. Typically, the CFilter function outputs this table.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="dob1507909044481__table_N10033_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:16.666666666666664%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d220442e243" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d220442e245" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d220442e247" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e243" rowspan="1" colspan="1"><var class="keyword varname">item1_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e245" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e247" rowspan="1" colspan="1">First item (item1). Column by which table is partitioned.
<p class="p">The database handles NULL values in partitioning columns. You need not exclude them with a WHERE clause.</p></td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e243" rowspan="1" colspan="1"><var class="keyword varname">item2_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e245" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e247" rowspan="1" colspan="1">Second item (item2).</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e243" rowspan="1" colspan="1"><var class="keyword varname">similarity_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e245" rowspan="1" colspan="1">INTEGER or DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e247" rowspan="1" colspan="1">Similarity score for item1 and item2 (number of times <var class="keyword varname">item1_column</var> co-occurs with <var class="keyword varname">item2_column</var>). To compute this score, use <a href="fmn1558545439769.md#diu1507746673334">CFilter (ML Engine)</a> function.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d220442e243" rowspan="1" colspan="1"><var class="keyword varname">accumulate_item_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d220442e245" rowspan="1" colspan="1">Any</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e247" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">accumulate_item_column</var>.] <span>Column to copy to output table.</span></td></tr></tbody></table></div>
<p class="p">This table must be symmetric with respect to <var class="keyword varname">item1_column</var> and <var class="keyword varname">item2_column</var>. That is, if a row has 'apple' in <var class="keyword varname">item1_column</var> and 'bread' in <var class="keyword varname">item2_column</var>, then another row must have 'bread' in <var class="keyword varname">item1_column</var> and 'apple' in <var class="keyword varname">item2_column</var>, and these two rows must have the same value in <var class="keyword varname">similarity_column</var>.</p></div><div class="section" id="dob1507909044481__section_svf_bxk_ycb">
<h3 class="title sectiontitle">UserTable Schema</h3>
<p class="p">This table contains the user preference for each item. The function recalculates these preferences, using the preferences of other items and how many times the item was bought with those items.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="dob1507909044481__table_N100AF_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:16.666666666666664%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d220442e341" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d220442e343" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d220442e345" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e341" rowspan="1" colspan="1"><var class="keyword varname">item_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e343" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e345" rowspan="1" colspan="1">Name of item that user viewed or bought. Column by which table is partitioned.
<p class="p">The database handles NULL values in partitioning columns. You need not exclude them with a WHERE clause.</p></td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e341" rowspan="1" colspan="1"><var class="keyword varname">user_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e343" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e345" rowspan="1" colspan="1">User identifier.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e341" rowspan="1" colspan="1"><var class="keyword varname">preference_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e343" rowspan="1" colspan="1">INTEGER</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e345" rowspan="1" colspan="1">User preference score for item.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d220442e341" rowspan="1" colspan="1"><var class="keyword varname">accumulate_user_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d220442e343" rowspan="1" colspan="1">Any</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e345" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">accumulate_user_column</var>.] <span>Column to copy to output table.</span></td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="eko1507909049714" xml:lang="en-us" lang="en-us" id="eko1507909049714">
<h2 class="title topictitle2" id="ariaid-title5">WSRecommender Output</h2><div class="body refbody"><div class="section" id="eko1507909049714__section_dxp_wwk_ycb">
<h3 class="title sectiontitle">Output Table Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="eko1507909049714__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:28.57142857142857%" span="1"></col><col style="width:14.285714285714285%" span="1"></col><col style="width:57.14285714285714%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d220442e406" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d220442e408" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d220442e410" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e406" rowspan="1" colspan="1">item</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e408" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e410" rowspan="1" colspan="1">Name of item that user viewed or bought. Corresponds to UserTable column <var class="keyword varname">item_column</var>.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e406" rowspan="1" colspan="1">usr</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e408" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e410" rowspan="1" colspan="1">Unique user identifier. Corresponds to UserTable column <var class="keyword varname">user_column</var>.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e406" rowspan="1" colspan="1">recommendation</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e408" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e410" rowspan="1" colspan="1">Recommendation score calculated using preferences of items bought with this item.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e406" rowspan="1" colspan="1">new_reco_flag</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e408" rowspan="1" colspan="1">INTEGER</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e410" rowspan="1" colspan="1">New recommendation flag. Indicates whether to recommend item to user: 1 (yes) if user never viewed or bought item and recommendation score is greater than 0; otherwise, 0 (no).</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e406" rowspan="1" colspan="1"><var class="keyword varname">accumulate_item_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d220442e408" rowspan="1" colspan="1">Same as in ItemTable</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d220442e410" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">accumulate_item_column</var>.] Column copied from ItemTable.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d220442e406" rowspan="1" colspan="1"><var class="keyword varname">accumulate_user_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d220442e408" rowspan="1" colspan="1">Same as in UserTable</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e410" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">accumulate_user_column</var>.] Column copied from UserTable.</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="gfe1510706605987" xml:lang="en-us" lang="en-us" id="gfe1510706605987">
<h2 class="title topictitle2" id="ariaid-title6">WSRecommender Example</h2><div class="body refbody"><div class="section" id="gfe1510706605987__section_ozv_mjr_tdb">
<h3 class="title sectiontitle">Input</h3>
<p class="p">The item table, recommender_product, contains product categories and their similarity scores. The similarity scores are from column cntb in <a href="fmn1558545439769.md#lzz1507746632895">CFilter Example: Filter by Customer Segment</a> Output Table cfilter_output1, which contains the number of co-occurrences of the items in product_category_a and product_category_b2.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="gfe1510706605987__table_cfn_vjr_tdb" class="table" frame="border" border="1" rules="all"><div class="caption"><span>recommender_product</span></div><colgroup span="1"><col style="width:25%" span="1"></col><col style="width:25%" span="1"></col><col style="width:25%" span="1"></col><col style="width:25%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d220442e514" rowspan="1" colspan="1">region</th><th class="entry cellrowborder" style="vertical-align:top;" id="d220442e516" rowspan="1" colspan="1">product_category_a</th><th class="entry cellrowborder" style="vertical-align:top;" id="d220442e518" rowspan="1" colspan="1">product_category_b</th><th class="entry cellrowborder" style="vertical-align:top;" id="d220442e520" rowspan="1" colspan="1">product_similarity</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">13</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">13</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Small Business</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">13</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">13</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">16</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Small Business</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">17</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">13</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">16</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Small Business</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">16</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Small Business</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">13</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Small Business</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">17</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e514" rowspan="1" colspan="1">Northern California</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e516" rowspan="1" colspan="1">Small Business</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e518" rowspan="1" colspan="1">Small Business</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e520" rowspan="1" colspan="1">16</td></tr></tbody></table></div>
<p class="p">The user table, recommender_user, contains the product preference (business presence) of four companies in four product categories, on a scale of 0 to 10 (10 is highest). For example, the table shows that in the Consumer product category, Company4 has a high business presence, while Company2 has none. The prod_preference 0 means that the company has never viewed or bought a product in that category.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="gfe1510706605987__table_p1z_q4r_tdb" class="table" frame="border" border="1" rules="all"><div class="caption"><span>recommender_user</span></div><colgroup span="1"><col style="width:25%" span="1"></col><col style="width:25%" span="1"></col><col style="width:25%" span="1"></col><col style="width:25%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d220442e644" rowspan="1" colspan="1">product_category</th><th class="entry cellrowborder" style="vertical-align:top;" id="d220442e646" rowspan="1" colspan="1">companyname</th><th class="entry cellrowborder" style="vertical-align:top;" id="d220442e648" rowspan="1" colspan="1">prod_preference</th><th class="entry cellrowborder" style="vertical-align:top;" id="d220442e650" rowspan="1" colspan="1">month</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">5</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">0</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">9</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">8</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">5</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">0</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">0</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">9</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">7</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e644" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e646" rowspan="1" colspan="1">Company4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e648" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d220442e650" rowspan="1" colspan="1">December</td></tr></tbody></table></div></div><div class="section" id="gfe1510706605987__section_ykf_njr_tdb">
<h3 class="title sectiontitle">SQL Call</h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM WSRecommender(
	ON ( SELECT * FROM WSRecommenderReduce(
			ON recommender_product AS ItemTable PARTITION BY product_category_a
			ON recommender_user AS UserTable PARTITION BY product_category
			USING
			ITEM1('product_category_a')
			ITEM2('product_category_b')
			ITEMSIMILARITYSCORE('product_similarity ')
			USERIDCOLUMN('companyname')
			USERITEMCOLUMN('product_category')
			USERPREFCOLUMN('prod_preference')
		) as dt1 ) PARTITION BY usr, col1_item2
) as dt ORDER BY recommendation desc,item;</code></pre></div><div class="section" id="gfe1510706605987__section_rcq_njr_tdb">
<h3 class="title sectiontitle">Output</h3>
<p class="p">If the company (usr) has ever viewed or bought items in the product category (item), then the recommendation column contains the value in the prod_preference column of the user table; otherwise, the column contains the recommendation score calculated by the function.</p>
<p class="p">If the recommendation value is greater than 0 and the company has never viewed or bought items in the product category (that is, the value in the prod_preference column of the user table is 0), then the new_reco_flag is 1, meaning that the product category is to be recommended to the company.</p><pre class="pre screen" xml:space="preserve"> item           usr      recommendation     new_reco_flag 
 -------------- -------- ------------------ ------------- 
 consumer       Company1                8.5             0
 corporate      Company2  7.515151500701904             0
 home office    Company1  7.488888740539551             1
 corporate      Company1  7.266666889190674             0
 consumer       Company3                7.0             0
 small business Company1  6.699999809265137             0
 corporate      Company3  6.310344696044922             0
 small business Company3   5.82608699798584             1
 consumer       Company2  5.333333492279053             1
 home office    Company4  5.137930870056152             0
 small business Company4  5.137930870056152             0
 home office    Company2                4.5             0
 home office    Company3  4.103448390960693             0
 corporate      Company4 3.9782607555389404             1
 small business Company2  3.909090995788574             0
 consumer       Company4                2.0             0</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div></div></body></html>
