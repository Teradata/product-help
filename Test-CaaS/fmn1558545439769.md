<html><head></head><body><div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="diu1507746673334" id="diu1507746673334"><h1 class="title topictitle1" id="ariaid-title1">CFilter (ML Engine)</h1><div class="body conbody">
<p class="p">A typical input table for the CFilter function is a set of sales transactions, with a column of purchased items and a column of something by which to group the purchased items; for example, a transaction id or time stamp.</p>
<p class="p">The CFilter function calculates several statistical measures of how likely each pair of items is to be purchased together. You can use CFilter output as input to the WSRecommender function, which performs item-based, collaborative filtering, using a weighted-sum algorithm, to make recommendations.</p></div><div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="vva1507746596598" xml:lang="en-us" lang="en-us" id="vva1507746596598">
<h2 class="title topictitle2" id="ariaid-title2">CFilter Syntax</h2><div class="body refbody"><div class="section" id="vva1507746596598__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">Version <span>1.12</span></h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM CFilter (
  <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> AS InputTable
  OUT TABLE OutputTable (<var class="keyword varname">output_table</var>)
  USING
  TargetColumns ({ '<var class="keyword varname">target_column</var>' | <var class="keyword varname">target_column_range</var> }[,...])
  JoinColumns ({ '<var class="keyword varname">join_column</var>' | <var class="keyword varname">join_column_range</var> }[,...])
  [ PartitionColumns ({ '<var class="keyword varname">partition_column</var>' | <var class="keyword varname">partition_column_range</var> }[,...]) ]
  [ PartitionKey ('<var class="keyword varname">partition_key_column</var>') ]
  [ MaxDistinctItems (<var class="keyword varname">max_distinct_items</var>) ]
) AS <var class="keyword varname">alias</var>;</code></pre></div></div><div class="related-links"><div class="linklistheader"><p></p><b>Related Information</b></div>
<ul class="linklist linklist relinfo"><div class="linklistmember"><a href="ndv1557782188375.md">Column Specification Syntax Elements</a></div></ul></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="xep1507746600435" xml:lang="en-us" lang="en-us" id="xep1507746600435">
<h2 class="title topictitle2" id="ariaid-title3">CFilter Syntax Elements</h2><div class="body refbody"><div class="section" id="xep1507746600435__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">OutputTable</dt><dd class="dd pd">Specify the name of the output table that the function creates. The table must not exist.</dd><dt class="dt pt dlterm">TargetColumns</dt><dd class="dd pd">Specify the names of the InputTable columns that contain the data to filter.</dd><dt class="dt pt dlterm">JoinColumns</dt><dd class="dd pd">Specify the names of join columns, which the function uses as follows:
<ol class="ol" id="xep1507746600435__ol_bmd_1x1_4z">
<li class="li">The function uses the items in each join column to define groups of items listed in the input columns.</li>
<li class="li">The function tries to identify items in each input column that often appear in the same group.</li></ol>
<p class="p">For example, a join column might contain a list of sales transactions from a store, and the input column might contain each individual item purchased at the store. A sales transaction can include multiple items. For each sales transaction, the function tries to identify items that often appear in the same sales transaction (that is, items that are often purchased together).</p></dd><dt class="dt pt dlterm">PartitionColumns</dt><dd class="dd pd">[Optional] Specify the names of the input columns to copy to the output table. The function partitions the input data and the output table on these columns.</dd><dd class="dd pd ddexpand">Specifying a column as both an <var class="keyword varname">partition_column</var> and a <var class="keyword varname">join_column</var> causes incorrect counts in partitions.</dd><dd class="dd pd ddexpand">This syntax element makes the function output nondeterministic unless each <var class="keyword varname">partition_column</var> is unique in the group defined by JoinColumns (for more information, see <a href="qym1549987102806.md">Nondeterministic Results and UniqueID Syntax Element</a>).</dd><dd class="dd pd ddexpand">Default behavior: The function treats the input data as belonging to one partition.</dd><dt class="dt pt dlterm">PartitionKey</dt><dd class="dd pd">[Optional] Specify the name of the output column to use as the partition key.</dd><dd class="dd pd ddexpand">Default: 'col1_item1'</dd><dt class="dt pt dlterm">MaxDistinctItems</dt><dd class="dd pd">[Optional] Specify the maximum size of the item set.</dd><dd class="dd pd ddexpand">The function uses <var class="keyword varname">max_item_set</var> to determine the size of the data structures it uses to accumulate intermediate results. If the number of distinct items in an <var class="keyword varname">target_column</var> is greater than <var class="keyword varname">max_item_set</var>, the function might report incorrect results without an error message.</dd><dd class="dd pd ddexpand">Default: 100 </dd></dl></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="iys1507746604525" xml:lang="en-us" lang="en-us" id="iys1507746604525">
<h2 class="title topictitle2" id="ariaid-title4">CFilter Input</h2><div class="body refbody"><div class="section" id="iys1507746604525__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">InputTable Schema</h3>
<p class="p"><span>The table can have additional columns, but the function ignores them.</span></p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="iys1507746604525__table_N10014_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:17.24137931034483%" span="1"></col><col style="width:13.793103448275861%" span="1"></col><col style="width:68.96551724137932%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d413147e241" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d413147e243" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d413147e245" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e241" rowspan="1" colspan="1"><var class="keyword varname">target_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e243" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e245" rowspan="1" colspan="1">Data to filter.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e241" rowspan="1" colspan="1"><var class="keyword varname">join_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e243" rowspan="1" colspan="1">Any</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e245" rowspan="1" colspan="1">Column to join.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d413147e241" rowspan="1" colspan="1"><var class="keyword varname">partition_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d413147e243" rowspan="1" colspan="1">Any</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e245" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">partition_column</var>.] <span>Column to copy to output table.</span> Used to partition input data and output table. Must not be a <var class="keyword varname">join_column</var>. Must be unique in the group defined by JoinColumns, or function output is nondeterministic (for more information, see <a href="qym1549987102806.md">Nondeterministic Results and UniqueID Syntax Element</a>).</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="ppu1507746609083" xml:lang="en-us" lang="en-us" id="ppu1507746609083">
<h2 class="title topictitle2" id="ariaid-title5">CFilter Output</h2><div class="body refbody"><div class="section" id="ppu1507746609083__section_c5f_sll_rgb">
<h3 class="title sectiontitle">Output Message Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ppu1507746609083__table_ysp_5ll_rgb" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e310" rowspan="1" colspan="1">Column</th><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e312" rowspan="1" colspan="1">Data Type</th><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e314" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e310" rowspan="1" colspan="1">message</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e312" rowspan="1" colspan="1">VARCHAR</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e314" rowspan="1" colspan="1">Reports that output table was created successfully.</td></tr></tbody></table></div></div><div class="section" id="ppu1507746609083__section_chq_zsk_ycb">
<h3 class="title sectiontitle">OutputTable Schema</h3>
<p class="p">Output is nondeterministic unless each <var class="keyword varname">add_column</var> is unique in the group defined by JoinColumns (for more information, see <a href="qym1549987102806.md">Nondeterministic Results and UniqueID Syntax Element</a>).</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ppu1507746609083__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:17.24137931034483%" span="1"></col><col style="width:13.793103448275861%" span="1"></col><col style="width:68.96551724137932%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d413147e349" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d413147e351" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d413147e353" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e349" rowspan="1" colspan="1">col1_item1</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e351" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e353" rowspan="1" colspan="1">Name of item1.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e349" rowspan="1" colspan="1">col1_item2</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e351" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e353" rowspan="1" colspan="1">Name of item2.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e349" rowspan="1" colspan="1">cntb</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e351" rowspan="1" colspan="1">INTEGER</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e353" rowspan="1" colspan="1">Count of co-occurrence of both items in partition.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e349" rowspan="1" colspan="1">cnt1</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e351" rowspan="1" colspan="1">INTEGER</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e353" rowspan="1" colspan="1">Count of occurrence of item1 in partition.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e349" rowspan="1" colspan="1">cnt2</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e351" rowspan="1" colspan="1">INTEGER</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e353" rowspan="1" colspan="1">Count of occurrence of item2 in partition.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e349" rowspan="1" colspan="1">score</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e351" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e353" rowspan="1" colspan="1">Product of two conditional probabilities:
<p class="p">P({ item2 | item1 }) * P({ item1 | item2 })</p>
<p class="p">Preceding product equals following quotient:</p>
<p class="p">(<var class="keyword varname">cntb</var> * <var class="keyword varname">cntb</var>)/(<var class="keyword varname">cnt1</var> * <var class="keyword varname">cnt2</var>)</p></td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e349" rowspan="1" colspan="1">support</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e351" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e353" rowspan="1" colspan="1">Percentage of transactions in partition in which the two items co-occur, calculated with this formula:
<p class="p"><var class="keyword varname">cntb</var>/<var class="keyword varname">tran_cnt</var></p>
<p class="p">where <var class="keyword varname">tran_cnt</var> is the number of transactions in the partition.</p>
<p class="p">For example, if eggs and milk were purchased together 3 times in 5 transactions in the same store, and the data is partitioned by store, then the support value in the partition is 3/5 = 0.6 = 60%.</p></td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e349" rowspan="1" colspan="1">confidence</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e351" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e353" rowspan="1" colspan="1">Percentage of transactions in partition in which item1 occurs, in which item2 also occurs, calculated with this formula:
<p class="p"><var class="keyword varname">cntb</var>/<var class="keyword varname">cnt1</var></p>
<p class="p">For example, if, in the same store, the number of times that a customer buys both milk (item1) and butter (item2) is 3 (cntb) and the number of times that a customer buys milk is 4 (cnt1), then the confidence that a person who buys milk will also buy butter is 3/4 = 0.75 = 75%.</p></td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e349" rowspan="1" colspan="1">lift</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e351" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e353" rowspan="1" colspan="1">Ratio of observed support value to expected support value if item1 and item2 were independent; that is:
<p class="p">support(item1 and item2) / [support(item1) * support(item2)]</p>
<p class="p">Value is calculated with this formula:</p>
<p class="p">(<var class="keyword varname">cntb</var>/<var class="keyword varname">tran_cnt</var>) / [(<var class="keyword varname">cnt1</var>/<var class="keyword varname">tran_cnt</var>) * (<var class="keyword varname">cnt2</var>/<var class="keyword varname">tran_cnt</var>)]</p>
<p class="p">If Lift > 1, the occurrence of item1 or item2 has a positive effect on the occurrence of the other items.</p>
<p class="p">If Lift = 1, the occurrence of item1 or item2 has a no effect on the occurrence of the other items.</p>
<p class="p">If Lift < 1, the occurrence of item1 or item2 has a negative effect on the occurrence of the other items.</p></td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d413147e349" rowspan="1" colspan="1">z_score</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d413147e351" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e353" rowspan="1" colspan="1">Significance of co-occurrence, assuming that cntb follows a normal distribution, calculated with this formula:
<p class="p">(<var class="keyword varname">cntb</var> - mean(<var class="keyword varname">cntb</var>)) / sd(<var class="keyword varname">cntb</var>)</p>
<p class="p">If all <var class="keyword varname">cntb</var> values are equal, then sd(<var class="keyword varname">cntb</var>) is 0, and function does not calculate zscore.</p></td></tr></tbody></table></div></div></div><div class="topic reference nested2" aria-labelledby="ariaid-title6" topicindex="6" topicid="xly1507746612839" xml:lang="en-us" lang="en-us" id="xly1507746612839">
<h3 class="title topictitle3" id="ariaid-title6">Deleting Duplicate Output Table Rows</h3><div class="body refbody"><div class="section" id="xly1507746612839__section_N1000E_N1000C_N10001">
<p class="p">Duplicate output table rows appear because each pair of items appears in two rows—one row has item1 in col1_item1 and item2 in col1_item2, and the other row has item2 in col1_item1 and item1 in col1_item2. To delete duplicate output table rows, use this code (where <var class="keyword varname">output_table</var> is the output table name):</p><pre class="pre codeblock" xml:space="preserve"><code>DROP TABLE copy;

CREATE MULTISET TABLE copy AS (
  SELECT *, ROW_NUMBER() OVER(ORDER BY col1_item1, col1_item2) rn
  FROM <var class="keyword varname">output_table</var>
) WITH DATA;

DROP TABLE DuplicatesRemoved;

CREATE MULTISET TABLE DuplicatesRemoved AS (
  SELECT * FROM copy
) WITH DATA;

DELETE FROM DuplicatesRemoved WHERE rn IN (
  SELECT a.rn FROM DuplicatesRemoved a
  JOIN copy b
  ON a.col1_item1=b.col1_item2 AND a.col1_item2=b.col1_item1 AND a.rn < b.rn
);

DROP TABLE copy;</code></pre><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="xly1507746612839__table_N1001C_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"><span>CFilter DuplicatesRemoved Table Schema</span></div><colgroup span="1"><col style="width:17.24137931034483%" span="1"></col><col style="width:13.793103448275861%" span="1"></col><col style="width:68.96551724137932%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d413147e544" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d413147e546" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d413147e548" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e544" rowspan="1" colspan="1">col1_item1</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e546" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e548" rowspan="1" colspan="1">Name of item1.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e544" rowspan="1" colspan="1">col1_item2</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d413147e546" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d413147e548" rowspan="1" colspan="1">Name of item2.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d413147e544" rowspan="1" colspan="1">rn</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d413147e546" rowspan="1" colspan="1">INTEGER</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e548" rowspan="1" colspan="1">Row number in <var class="keyword varname">output_table</var> when ordered by col1_item1, col1_item2.</td></tr></tbody></table></div></div></div></div></div><div class="topic concept nested1" aria-labelledby="ariaid-title7" topicindex="7" topicid="qmc1510706307192" xml:lang="en-us" lang="en-us" id="qmc1510706307192">
<h2 class="title topictitle2" id="ariaid-title7">CFilter Examples</h2><div class="topic reference nested2" aria-labelledby="ariaid-title8" topicindex="8" topicid="pmm1507746620724" xml:lang="en-us" lang="en-us" id="pmm1507746620724">
<h3 class="title topictitle3" id="ariaid-title8">CFilter Example: Filter by Product</h3><div class="body refbody"><div class="section" id="pmm1507746620724__section_N10011_N1000E_N10001">
<p class="p">Collaborative filtering by product is also called item-based collaborative filtering. In this example, JoinColumns = 'orderid'. The function tries to identify products that are often bought in the same transaction (as identified by the order_id).</p></div><div class="section" id="pmm1507746620724__section_zsv_22r_t2b">
<h4 class="title sectiontitle">Input</h4>The InputTable has sales transaction data from an office supply chain store, in these columns:
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="pmm1507746620724__table_a3y_32r_t2b" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e616" rowspan="1" colspan="1">Column</th><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e618" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e616" rowspan="1" colspan="1">orderid</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e618" rowspan="1" colspan="1">Order (transaction) identifier</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e616" rowspan="1" colspan="1">orderdate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e618" rowspan="1" colspan="1">Order date</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e616" rowspan="1" colspan="1">orderqty</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e618" rowspan="1" colspan="1">Quantity of product ordered</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e616" rowspan="1" colspan="1">region</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e618" rowspan="1" colspan="1">Geographic region of store where order was placed</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e616" rowspan="1" colspan="1">customer_segment</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e618" rowspan="1" colspan="1">Segment of customer who ordered product</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e616" rowspan="1" colspan="1">prd_category</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e618" rowspan="1" colspan="1">Category of product ordered</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e616" rowspan="1" colspan="1">product</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e618" rowspan="1" colspan="1">Product ordered</td></tr></tbody></table></div><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="pmm1507746620724__table_jw1_p2r_t2b" class="table" frame="border" border="1" rules="all"><div class="caption"><span>InputTable: sales_transaction</span></div><colgroup span="1"><col style="width:14.285714285714285%" span="1"></col><col style="width:14.285714285714285%" span="1"></col><col style="width:14.285714285714285%" span="1"></col><col style="width:14.285714285714285%" span="1"></col><col style="width:14.285714285714285%" span="1"></col><col style="width:14.285714285714285%" span="1"></col><col style="width:14.285714285714285%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e669" rowspan="1" colspan="1">orderid</th><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e671" rowspan="1" colspan="1">orderdate</th><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e673" rowspan="1" colspan="1">orderqty</th><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e675" rowspan="1" colspan="1">region</th><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e677" rowspan="1" colspan="1">customer_segment</th><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e679" rowspan="1" colspan="1">prd_category</th><th class="entry cellrowborder" style="vertical-align:top;" id="d413147e681" rowspan="1" colspan="1">product</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2010-10-13 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">6</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Small Business</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Storage &amp; Organization</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">293</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2012-10-01 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">49</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Appliances</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">293</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2012-10-01 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">27</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Binders and Binder Accessories</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">483</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2011-07-10 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">30</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Technology</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Telephones and Communication</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">515</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2010-08-28 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">19</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Appliances</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">515</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2010-08-28 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">21</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Consumer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Furniture</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Office Furnishings</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">613</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2011-06-17 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">12</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Binders and Binder Accessories</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">613</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2011-06-17 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">22</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Storage &amp; Organization</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">643</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2011-03-24 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">21</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Corporate</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Storage &amp; Organization</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">678</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2010-02-26 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">44</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Paper</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">807</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2010-11-23 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">45</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Paper</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">807</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2010-11-23 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">32</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Rubber Bands</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">868</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">2012-06-08 00:00:00</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">32</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">Nunavut</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">Home Office</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">Office Supplies</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">Appliances</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e669" rowspan="1" colspan="1">...</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e671" rowspan="1" colspan="1">...</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e673" rowspan="1" colspan="1">...</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e675" rowspan="1" colspan="1">...</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e677" rowspan="1" colspan="1">...</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e679" rowspan="1" colspan="1">...</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d413147e681" rowspan="1" colspan="1">...</td></tr></tbody></table></div></div><div class="section" id="pmm1507746620724__section_wmm_ryq_tdb">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM CFilter (
  ON sales_transaction AS InputTable
  OUT TABLE OutputTable (cfilter_output)
  USING
  TargetColumns ('product')
  JoinColumns ('orderid')
  PartitionColumns ('region')
) AS dt;</code></pre></div><div class="section" id="pmm1507746620724__section_q1y_ryq_tdb">
<h4 class="title sectiontitle">Output</h4><pre class="pre screen" xml:space="preserve">              message              
-----------------------------------
 Output table created successfully
(1 row)</pre><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM cfilter_output;</code></pre><pre class="pre screen" xml:space="preserve"> region                col1_item1                     col1_item2                     cntb cnt1 cnt2 score                 support               confidence           lift                z_score             
 --------------------- ------------------------------ ------------------------------ ---- ---- ---- --------------------- --------------------- -------------------- ------------------- ------------------- 
 northwest territories binders and binder accessories labels                            2   44   16  0.005681818181818182  0.007434944237918215 0.045454545454545456  0.7642045454545454 0.12784297268860556
 northwest territories tables                         labels                            1   12   16  0.005208333333333333 0.0037174721189591076  0.08333333333333333  1.4010416666666667 -0.8522864845907044
 northwest territories computer peripherals           labels                            1   30   16 0.0020833333333333333 0.0037174721189591076  0.03333333333333333  0.5604166666666667 -0.8522864845907044
 nunavut               tables                         bookcases                         1    1    2                   0.5  0.017857142857142856                  1.0                28.0 -0.4588314677411239
 northwest territories binders and binder accessories tables                            2   44   12  0.007575757575757576  0.007434944237918215 0.045454545454545456   1.018939393939394 0.12784297268860556
 nunavut               labels                         rubber bands                      1    4    2                 0.125  0.017857142857142856                 0.25                 7.0 -0.4588314677411239
 nunavut               binders and binder accessories computer peripherals              1   10    6  0.016666666666666666  0.017857142857142856                  0.1  0.9333333333333333 -0.4588314677411239
 northwest territories labels                         binders and binder accessories    2   16   44  0.005681818181818182  0.007434944237918215                0.125  0.7642045454545454 0.12784297268860556
 northwest territories binders and binder accessories rubber bands                      3   44   10  0.020454545454545454  0.011152416356877323  0.06818181818181818   1.834090909090909  1.1079724299679155
 northwest territories labels                         paper                             2   16   40               0.00625  0.007434944237918215                0.125            0.840625 0.12784297268860556
 northwest territories computer peripherals           binders and binder accessories    3   30   44  0.006818181818181818  0.011152416356877323                  0.1  0.6113636363636363  1.1079724299679155
 atlantic              labels                         pens &amp; art supplies               1    3    2   0.16666666666666666   0.05555555555555555   0.3333333333333333                 3.0                NULL
...</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div><div class="topic reference nested2" aria-labelledby="ariaid-title9" topicindex="9" topicid="lzz1507746632895" xml:lang="en-us" lang="en-us" id="lzz1507746632895">
<h3 class="title topictitle3" id="ariaid-title9">CFilter Example: Filter by Customer Segment</h3><div class="body refbody"><div class="section" id="lzz1507746632895__section_N10011_N1000E_N10001">
<p class="p">In this example, JoinColumns = 'product'. The function tries to identify segments of customers that often purchase the same products.</p></div><div class="section" id="lzz1507746632895__section_fvl_z2r_t2b">
<h4 class="title sectiontitle">Input</h4>
<ul class="ul" id="lzz1507746632895__ul_c2b_1fr_t2b">
<li class="li">InputTable: sales_transaction, as in <a href="fmn1558545439769.md#pmm1507746620724">CFilter Example: Filter by Product</a></li></ul></div><div class="section" id="lzz1507746632895__section_wmm_ryq_tdb">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM CFilter (
  ON sales_transaction AS InputTable
  OUT TABLE OutputTable (cfilter_output1)
  USING
  TargetColumns ('customer_segment')
  JoinColumns ('product')
) AS dt;</code></pre></div><div class="section" id="lzz1507746632895__section_q1y_ryq_tdb">
<h4 class="title sectiontitle">Output</h4><pre class="pre codeblock" xml:space="preserve"><code>              message              
-----------------------------------
 Output table created successfully
(1 row)</code></pre><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM cfilter_output1;</code></pre><pre class="pre screen" xml:space="preserve"> col1_item1     col1_item2     cntb cnt1 cnt2 score              support            confidence         lift   z_score             
 -------------- -------------- ---- ---- ---- ------------------ ------------------ ------------------ ------ ------------------- 
 corporate      small business   17   17   17                1.0                1.0                1.0    1.0  1.3728129459672886
 home office    small business   16   16   17 0.9411764705882353 0.9411764705882353                1.0    1.0  0.7844645405527365
 consumer       small business   13   13   17 0.7647058823529411 0.7647058823529411                1.0    1.0 -0.9805806756909198
 home office    consumer         13   16   13             0.8125 0.7647058823529411             0.8125 1.0625 -0.9805806756909198
 consumer       corporate        13   13   17 0.7647058823529411 0.7647058823529411                1.0    1.0 -0.9805806756909198
 small business corporate        17   17   17                1.0                1.0                1.0    1.0  1.3728129459672886
 corporate      home office      16   17   16 0.9411764705882353 0.9411764705882353 0.9411764705882353    1.0  0.7844645405527365
 small business home office      16   17   16 0.9411764705882353 0.9411764705882353 0.9411764705882353    1.0  0.7844645405527365
 corporate      consumer         13   17   13 0.7647058823529411 0.7647058823529411 0.7647058823529411    1.0 -0.9805806756909198
 small business consumer         13   17   13 0.7647058823529411 0.7647058823529411 0.7647058823529411    1.0 -0.9805806756909198
 consumer       home office      13   13   16             0.8125 0.7647058823529411                1.0 1.0625 -0.9805806756909198
 home office    corporate        16   16   17 0.9411764705882353 0.9411764705882353                1.0    1.0  0.7844645405527365</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div></div></div></body></html>
