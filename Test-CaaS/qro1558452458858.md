<html><head></head><body><div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="eju1507835240829" id="eju1507835240829"><h1 class="title topictitle1" id="ariaid-title1">MultiCaseMatch (ML Engine)</h1><div class="body conbody">
<p class="p">The MultiCaseMatch function extends the capability of the SQL CASE statement by supporting matches to multiple criteria in a single row.</p>
<p class="p">When SQL CASE finds a match, it outputs the result and immediately
			proceeds to the next row without searching for more matches in the current row.</p>
<p class="p">The MultiCaseMatch function iterates through the input data set only once and outputs matches whenever a match occurs. If multiple matches occur for a given input row, the function outputs one output row for each match.</p>
<p class="p">Use the MultiCaseMatch function when the conditions in your CASE statement do not form a mutually exclusive set.</p></div><div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="mdj1507835568043" xml:lang="en-us" lang="en-us" id="mdj1507835568043">
<h2 class="title topictitle2" id="ariaid-title2">MultiCaseMatch Syntax</h2><div class="body refbody"><div class="section" id="mdj1507835568043__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">Version 1.5</h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM MultiCaseMatch (
  ON (SELECT t.*, <var class="keyword varname">condition</var> AS <var class="keyword varname">case</var> [,...] FROM { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) } AS t)
  USING
  Labels ('<var class="keyword varname">case</var> AS "<var class="keyword varname">label</var>"' [,...])
) AS <var class="keyword varname">alias</var>;</code></pre></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="xqa1507835573379" xml:lang="en-us" lang="en-us" id="xqa1507835573379">
<h2 class="title topictitle2" id="ariaid-title3">MultiCaseMatch Syntax Elements</h2><div class="body refbody"><div class="section" id="xqa1507835573379__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">Labels</dt><dd class="dd pd">Specify a label for each <var class="keyword varname">case</var>. Each case corresponds to a <var class="keyword varname">condition</var>, which is a SQL predicate that includes input column names. When an input value satisfies <var class="keyword varname">condition</var>, that is a match, and the function outputs the input row and the corresponding label.</dd></dl></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="nvl1507835618904" xml:lang="en-us" lang="en-us" id="nvl1507835618904">
<h2 class="title topictitle2" id="ariaid-title4">MultiCaseMatch Input</h2><div class="body refbody"><div class="section" id="nvl1507835618904__section_pds_mhs_ycb">
<h3 class="title sectiontitle">Input Table Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="nvl1507835618904__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:22.22222222222222%" span="1"></col><col style="width:11.11111111111111%" span="1"></col><col style="width:66.66666666666666%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d393620e142" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d393620e144" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d393620e146" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d393620e142" rowspan="1" colspan="1"><var class="keyword varname">column_in_condition</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d393620e144" rowspan="1" colspan="1">Any</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d393620e146" rowspan="1" colspan="1">[Column appears once for each column specified in a <var class="keyword varname">condition</var>.]</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d393620e142" rowspan="1" colspan="1"><var class="keyword varname">other_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d393620e144" rowspan="1" colspan="1">Any</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e146" rowspan="1" colspan="1">[Column appears zero or more times.] <span>Column to copy to output table.</span></td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="nug1507835578504" xml:lang="en-us" lang="en-us" id="nug1507835578504">
<h2 class="title topictitle2" id="ariaid-title5">MultiCaseMatch Output</h2><div class="body refbody"><div class="section" id="nug1507835578504__section_psy_khs_ycb">
<h3 class="title sectiontitle">Output Table Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="nug1507835578504__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:20%" span="1"></col><col style="width:13.333333333333334%" span="1"></col><col style="width:66.66666666666666%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d393620e189" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d393620e191" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d393620e193" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d393620e189" rowspan="1" colspan="1"><var class="keyword varname">column_in_condition</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d393620e191" rowspan="1" colspan="1"><span>Same as in Input table</span></td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d393620e193" rowspan="1" colspan="1">[Column appears once for each column specified in a <var class="keyword varname">condition</var>.] <span>Column copied from input table.</span></td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d393620e189" rowspan="1" colspan="1">labels</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d393620e191" rowspan="1" colspan="1">VARCHAR</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e193" rowspan="1" colspan="1">[Column appears once for each matching label.] Labels that correspond to case that <var class="keyword varname">column_in_condition</var> value matches.</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="eej1507836139044" xml:lang="en-us" lang="en-us" id="eej1507836139044">
<h2 class="title topictitle2" id="ariaid-title6">MultiCaseMatch Example</h2><div class="body refbody"><div class="section" id="eej1507836139044__section_N10011_N1000E_N10001">
<p class="p">This example labels people with the age groups to which they belong, which overlap:</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="eej1507836139044__table_qhz_jyw_v1b" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d393620e249" rowspan="1" colspan="1">Age Group</th><th class="entry cellrowborder" style="vertical-align:top;" id="d393620e251" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e249" rowspan="1" colspan="1">infant</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e251" rowspan="1" colspan="1">Younger than 1 year</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e249" rowspan="1" colspan="1">toddler</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e251" rowspan="1" colspan="1">1-2 years, inclusive</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e249" rowspan="1" colspan="1">kid</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e251" rowspan="1" colspan="1">2-12 years, inclusive</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e249" rowspan="1" colspan="1">teenager</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e251" rowspan="1" colspan="1">13-19 years, inclusive</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e249" rowspan="1" colspan="1">young adult</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e251" rowspan="1" colspan="1">16-25 years, inclusive</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e249" rowspan="1" colspan="1">adult</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e251" rowspan="1" colspan="1">21-40 years, inclusive</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e249" rowspan="1" colspan="1">middle-aged person</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e251" rowspan="1" colspan="1">35-60 years, inclusive</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e249" rowspan="1" colspan="1">senior citizen</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e251" rowspan="1" colspan="1">60 years or older</td></tr></tbody></table></div></div><div class="section" id="eej1507836139044__section_cc1_gf3_xdb">
<h3 class="title sectiontitle">Input</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="eej1507836139044__table_mdv_jf3_xdb" class="table" frame="border" border="1" rules="all"><div class="caption"><span>people_age</span></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d393620e306" rowspan="1" colspan="1">id</th><th class="entry cellrowborder" style="vertical-align:top;" id="d393620e308" rowspan="1" colspan="1">name</th><th class="entry cellrowborder" style="vertical-align:top;" id="d393620e310" rowspan="1" colspan="1">age</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">John</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">0.5</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">Freddy</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">2</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">Marie</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">6</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">Tom Sawyer</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">17</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">5</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">Becky Thatcher</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">16</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">6</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">Philip</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">22</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">7</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">Joseph</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">25</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">8</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">Roger</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">35</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">9</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">Natalie</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">30</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">10</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">Henry</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">40</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">11</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">George</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">50</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e306" rowspan="1" colspan="1">12</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e308" rowspan="1" colspan="1">Sir William</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d393620e310" rowspan="1" colspan="1">65</td></tr></tbody></table></div></div><div class="section" id="eej1507836139044__section_eqk_gf3_xdb">
<h3 class="title sectiontitle">SQL Call</h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM MultiCaseMatch (
ON (SELECT t.*, 
   (case when t.age < 1 THEN '1' ELSE '0' END) AS case1,
   (case when t.age >= 1 AND t.age <= 2 THEN '1' ELSE '0' END) AS case2,
   (case when t.age >= 2 AND t.age <= 12 THEN '1' ELSE '0' END) AS case3,
   (case when t.age >= 13 AND t.age <= 19 THEN '1' ELSE '0' END) AS case4,
   (case when t.age >= 16 AND t.age <= 25 THEN '1' ELSE '0' END) AS case5,
   (case when t.age >= 21 AND t.age <= 40 THEN '1' ELSE '0' END) AS case6,
   (case when t.age >= 35 AND t.age <= 60 THEN '1' ELSE '0' END) AS case7,
   (case when t.age >= 60 THEN '1' ELSE '0' END) AS case8
   FROM people_age AS t)
USING
   LABELS (
     'case1 AS "infant"',
     'case2 AS "toddler"',
     'case3 AS "kid"',
     'case4 AS "teenager"',
     'case5 AS "young adult"',
     'case6 AS "adult"',
     'case7 AS "middle aged person"',
     'case8 AS "senior citizen"')
  ) AS dt;</code></pre></div><div class="section" id="eej1507836139044__section_a1x_gf3_xdb">
<h3 class="title sectiontitle">Output</h3>
<p class="p">Several people have two labels. For example, Freddy is both a toddler and a kid, and Tom Sawyer and Becky Thatcher are both teenagers and young adults.</p><pre class="pre screen" xml:space="preserve"> id name           age  labels             
 -- -------------- ---- ------------------ 
  7 joseph         25.0 young adult       
  6 philip         22.0 young adult       
  7 joseph         25.0 adult             
  6 philip         22.0 adult             
 12 sir william    65.0 senior citizen    
 11 george         50.0 middle aged person
  4 tom sawyer     17.0 teenager          
  9 natalie        30.0 adult             
  4 tom sawyer     17.0 young adult       
 10 henry          40.0 adult             
  5 becky thatcher 16.0 teenager          
 10 henry          40.0 middle aged person
  5 becky thatcher 16.0 young adult       
  3 marie           6.0 kid               
  1 john            0.5 infant            
  8 roger          35.0 adult             
  8 roger          35.0 middle aged person
  2 freddy          2.0 toddler           
  2 freddy          2.0 kid</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div></div></body></html>
