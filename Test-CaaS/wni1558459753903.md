<html><head></head><body><div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="gcv1507756303341" id="gcv1507756303341"><h1 class="title topictitle1" id="ariaid-title1">Modularity (ML Engine)</h1><div class="body conbody">
<p class="p">The Modularity function uses a clustering algorithm to detect communities
			in networks (graphs).The function needs no prior knowledge or estimation of starting
			cluster centers and assumes no particular data distribution of the input data set.</p><div class="fig fignone" id="gcv1507756303341__fig_pmp_dgk_pw"><div class="caption"></div><br clear="none"></br><img class="image" id="gcv1507756303341__image_jjy_dgk_pw" src="tco1466005863673.svg" alt="How Machine Learning Engine function Modularity works"></img><br clear="none"></br></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="sdb1507756361002" xml:lang="en-us" lang="en-us" id="sdb1507756361002">
<h2 class="title topictitle2" id="ariaid-title2">Modularity Background</h2><div class="body refbody"><div class="section" id="sdb1507756361002__section_N1000E_N1000C_N10001">
<p class="p">Community detection and identification is important for understanding network dynamics. In this context, a <dfn class="term">community</dfn> (also called a <dfn class="term">module</dfn>, <dfn class="term">group</dfn>, or <dfn class="term">cluster</dfn>) refers to a subset of a network consisting of nodes that are more highly interconnected with each other than they are with nodes that are not part of the community. Identifying these communities can be valuable in many different network analysis problems. For example, diffusion of information or disease is faster within a densely connected social community than within a more loosely connected group.</p>
<p class="p"><dfn class="term">Modularity</dfn> is a measure of the quality of a division of a network into communities, or modules. It is defined by the following equation, which compares the density of links within communities to the density of links between communities. Modularity is a numeric value between 1 and -1, with values closer to 1 indicating better community formation (that is, a division of the network with dense within-community connections and sparse between-community connections).</p>
<p class="p"><span><b>ML Engine</b></span> Modularity function is based on the algorithm described in the paper <cite class="cite">Fast unfolding of communities in large networks; VD Blondel, JL Guillaume, R Lambiotte, E Lefebvre; Journal of Statistical Mechanics: Theory and Experiment, Volume 2008, October 2008</cite>.</p></div><div class="section" id="sdb1507756361002__section_w3k_wsd_gz">
<h3 class="title sectiontitle">Modularity Equation</h3><div class="fig fignone" id="sdb1507756361002__fig_drz_dwf_gz"><div class="caption"></div><img class="image" id="sdb1507756361002__image_cwx_cwf_gz" src="sce1489609817905.png" alt="Modularity equation (Machine Learning Engine function Modularity)"></img></div><div class="p">In the modularity equation:
<ul class="ul" id="sdb1507756361002__ul_zn3_gtd_gz">
<li class="li"><var class="keyword varname">A</var><span><sub><var class="keyword varname">ij</var></sub></span> is the weight of the edge between nodes <var class="keyword varname">i</var> and <var class="keyword varname">j</var>.</li>
<li class="li"><var class="keyword varname">k</var><span><sub><var class="keyword varname">i</var></sub></span> is the sum of the weights of the edges of node <var class="keyword varname">i</var>.</li>
<li class="li"><var class="keyword varname">m</var> is the total weight of all edges in the network. For an unweighted network, the weight of each edge is 1.</li>
<li class="li"><var class="keyword varname">δ</var>(<var class="keyword varname">c</var><span><sub><var class="keyword varname">i</var></sub></span>,<var class="keyword varname">c</var><span><sub><var class="keyword varname">j</var></sub></span>) is 1 when nodes <var class="keyword varname">i</var> and <var class="keyword varname">j</var> are in the same community, and 0 otherwise.</li></ul></div>
<p class="p">This modularity equation is equivalent to the preceding one:</p><div class="fig fignone" id="sdb1507756361002__fig_t2b_gb2_gz"><div class="caption"></div><img class="image" id="sdb1507756361002__image_qfy_gwf_gz" src="wzg1489610047759.png" alt="Modularity equation equivalent to preceding equation (Machine Learning Engine function Modularity)"></img></div></div><div class="section" id="sdb1507756361002__section_tty_lb2_gz">
<h3 class="title sectiontitle">Use Cases</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="sdb1507756361002__table_g4t_r22_gz" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:40%" span="1"></col><col style="width:60%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d93182e159" rowspan="1" colspan="1">Field</th><th class="entry cellrowborder" style="vertical-align:top;" id="d93182e161" rowspan="1" colspan="1">What Modularity Analysis Identifies</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e159" rowspan="1" colspan="1">Social network analysis</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e161" rowspan="1" colspan="1">
<ul class="ul" id="sdb1507756361002__ul_wvv_3g2_gz">
<li class="li">Communities of acquaintances</li>
<li class="li">Circles of influence</li></ul></td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e159" rowspan="1" colspan="1">Telecom</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e161" rowspan="1" colspan="1">
<ul class="ul" id="sdb1507756361002__ul_d2z_5g2_gz">
<li class="li">Groups of customers where most communications happen within the group</li></ul></td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e159" rowspan="1" colspan="1">Banking and finance</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e161" rowspan="1" colspan="1">
<ul class="ul" id="sdb1507756361002__ul_jrp_nf2_gz">
<li class="li">Business relationships, such as supply chains or capital chains</li>
<li class="li">Potentially fraudulent transactions or communications</li></ul></td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e159" rowspan="1" colspan="1">Web site optimization</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e161" rowspan="1" colspan="1">
<ul class="ul" id="sdb1507756361002__ul_gph_rf2_gz">
<li class="li">Pages with similar subjects</li>
<li class="li">Pages likely to be accessed in the same session</li></ul></td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e159" rowspan="1" colspan="1">Retail</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e161" rowspan="1" colspan="1">
<ul class="ul" id="sdb1507756361002__ul_qrl_vg2_gz">
<li class="li">Target customers for specific products</li>
<li class="li">Product recommendations for specific customers</li>
<li class="li">Products that are becoming more or less popular (forecasting)</li></ul></td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e159" rowspan="1" colspan="1">Public health</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e161" rowspan="1" colspan="1">
<ul class="ul" id="sdb1507756361002__ul_fs4_vg2_gz">
<li class="li">People who may be at risk for a disease or condition</li></ul></td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e159" rowspan="1" colspan="1">Computer network security</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e161" rowspan="1" colspan="1">
<ul class="ul" id="sdb1507756361002__ul_vcw_vg2_gz">
<li class="li">Systems at risk for a virus or malware attack</li></ul></td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="pwb1507756421710" xml:lang="en-us" lang="en-us" id="pwb1507756421710">
<h2 class="title topictitle2" id="ariaid-title3">Resolution</h2><div class="body refbody"><div class="section" id="pwb1507756421710__section_N1000E_N1000C_N10001">
<p class="p">Resolution controls the hierarchical-level information about community formation. It represents the level in a dendrogram at which to converge for the number of communities to detect. Think of different resolution points as different hierarchical levels in a tree of nodes interconnected through an edge table.</p>
<p class="p">Here are two ways to think of resolution:</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="pwb1507756421710__table_gvk_nl2_3y" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d93182e243" rowspan="1" colspan="1">Higher Resolution (> 1.0)</th><th class="entry cellrowborder" style="vertical-align:top;" id="d93182e245" rowspan="1" colspan="1">Lower Resolution</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e243" rowspan="1" colspan="1">Provides a visualization of the graph nearer the root of the tree.</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e245" rowspan="1" colspan="1">Provides a visualization of the graph nearer the leaves of the tree.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e243" rowspan="1" colspan="1">Zooms out , providing fewer, larger communities.</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e245" rowspan="1" colspan="1">Zooms in , providing more, smaller communities.</td></tr></tbody></table></div>
<p class="p">In the following figure, the x-axis represents the nodes in a sample graph and y-axis represents the community resolution level of the hierarchical tree structure of the graph. For example, at resolution level 0.75, the graph has 7 communities, and at resolution level 1.0, the graph has 5 communities.</p><div class="fig fignone" id="pwb1507756421710__fig_N10022_N1000E_N1000C_N10001"><div class="caption"><span>Resolution Levels</span></div><br clear="none"></br><img class="image" id="pwb1507756421710__image_qjk_jdf_lw" src="wpl1466005867050.png" alt="Graph of resolution levels with graph nodes on x axis and resolution on y axis (Machine Learning Engine function Modularity)"></img><br clear="none"></br>
<p class="p">Resolution is useful for:</p>
<ul class="ul">
<li class="li">Visualizing hierarchical graph structure</li>
<li class="li">Finding the expected number of communities in a graph</li>
<li class="li">Finding the community structure in a graph when some nodes are expected to
                        belong to the same community</li></ul>
<p class="p">For visualizing hierarchical graph structure, the default resolution (1.0) maximizes modularity and is therefore expected to provide the best community structure. Possible exceptions are the second and third preceding use cases, or a graph that includes estimation errors (for example, when edge weights are statistically computed based on behavior similarity among nodes).</p>
<p class="p">For the third use case, an alternative to changing the resolution is to put the nodes that are expected to belong to the same community in one group in the vertices table and specify that group in the CommunityAssociation syntax element.</p></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="lqx1507756501308" xml:lang="en-us" lang="en-us" id="lqx1507756501308">
<h2 class="title topictitle2" id="ariaid-title4">Modularity Syntax</h2><div class="body refbody"><div class="section" id="lqx1507756501308__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">Version <span>1.6</span></h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM Modularity (
  <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> AS Vertices PARTITION BY <var class="keyword varname">vertex_key_column</var> [,...] 
  <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> AS Edges PARTITION BY <var class="keyword varname">source_vertex_key_column</var> [,...] 
  [ <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> AS Sources PARTITION BY <var class="keyword varname">vertex_key_column</var> [,...] ]
  [ OUT TABLE CommunityEdgeTable (<var class="keyword varname">community_edge_table</var>) ]
  USING
  TargetKey ({ '<var class="keyword varname">target_key_column</var>' | <var class="keyword varname">target_key_column_range</var> }[,...])
  [ EdgeWeight (<var class="keyword varname">edge_weight</var>) ]
  [ CommunityAssociation ('<var class="keyword varname">community_id</var>') ]
  [ Resolution (<var class="keyword varname">resolution</var> [,...]) ]
  [ Seed (<var class="keyword varname">seed</var>) ]
  <code class="ph codeph">[ Accumulate ({ '<var class="keyword varname">accumulate_column</var>' | <var class="keyword varname">accumulate_column_range</var> }[,...]) ]</code>
) AS <var class="keyword varname">alias</var>;</code></pre></div></div><div class="related-links"><div class="linklistheader"><p></p><b>Related Information</b></div>
<ul class="linklist linklist relinfo"><div class="linklistmember"><a href="ndv1557782188375.md">Column Specification Syntax Elements</a></div></ul></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="cud1507756639473" xml:lang="en-us" lang="en-us" id="cud1507756639473">
<h2 class="title topictitle2" id="ariaid-title5">Modularity Syntax Elements</h2><div class="body refbody"><div class="section" id="cud1507756639473__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">CommunityEdgeTable</dt><dd class="dd pd">[Optional] Specify the name of the table that the function creates to output the weights of the edges between the communities at different resolution levels. If you omit this syntax element, the function does not create this table.</dd><dt class="dt pt dlterm">TargetKey</dt><dd class="dd pd">Specify the key of the target vertex of an edge. The key consists of the names of one or more Edges table columns.</dd><dt class="dt pt dlterm">EdgeWeight</dt><dd class="dd pd">[Optional] Specify the name of the Edges table column that contains edge weights. Each <var class="keyword varname">edge_weight</var> is a positive value.</dd><dd class="dd pd ddexpand">Default behavior: The weight of each edge is 1 (that is, the graph is unweighted).
<p class="p">This syntax element determines how the function treats duplicate edges (that is, edges with the same source and destination, which might have different weights). For a weighted graph, the function treats duplicate edges as a single edge whose weight is the sum of the weights of the duplicate edges. For an unweighted graph, the function uses only one of the duplicate edges.</p></dd><dt class="dt pt dlterm">CommunityAssociation</dt><dd class="dd pd">[Optional] Specify the name of the column that represents the community association of the vertices. Use this syntax element if you know some vertex communities.</dd><dt class="dt pt dlterm">Resolution</dt><dd class="dd pd">[Optional] Specify hierarchical-level information for the communities. For details, see <a href="wni1558459753903.md#pwb1507756421710">Resolution</a>. If you specify a list of <var class="keyword varname">resolution</var> values, the function incrementally finds the communities for each value and for the default value.</dd><dd class="dd pd ddexpand">Each <var class="keyword varname">resolution</var> must be a distinct DOUBLE PRECISION value in the range [0.0, 1000000.0]. The value 0.0 puts each node in its own community of size 1. You can specify a maximum of 500 <var class="keyword varname">resolution</var> values.</dd><dd class="dd pd ddexpand">Default: 1.0</dd><dt class="dt pt dlterm">Seed</dt><dd class="dd pd">[Optional] Specify the random seed the algorithm uses for repeatable results. The <var class="keyword varname">seed</var> must be a LONG value greater than or equal to 1. The algorithm multiplies <var class="keyword varname">seed</var> by the hash code of <var class="keyword varname">vertex_key</var> to create a unique seed for each vertex.<div class="note note" id="cud1507756639473__note_N1009F_N1008C_N10085_N10018_N10014_N10010_N10001"><span><b>Note</b></span><div class="notebody"> For repeatable results, use both the Seed and UniqueID syntax elements. For more information, see <a href="qym1549987102806.md">Nondeterministic Results and UniqueID Syntax Element</a>.</div></div></dd><dd class="dd pd ddexpand">The function also uses <var class="keyword varname">seed</var> for these purposes:
<ul class="ul" id="cud1507756639473__ul_xmg_dyt_gy">
<li class="li">To break ties between different vertices during community formation</li>
<li class="li">To determine when to stop community formation
<p class="p">If <var class="keyword varname">seed</var> is 1 (default value), community formation continues until the change in modularity score drops below a threshold value. The threshold value is set in the function code; you cannot change it.</p>
<p class="p">If <var class="keyword varname">seed</var> is set to any other value, community formation continues until the change in modularity score between iterations is 0. This deeper analysis of the graph can improve community formation, but can also increase execution time.</p></li></ul></dd><dd class="dd pd ddexpand">Default: 1</dd><dt class="dt pt dlterm">Accumulate</dt><dd class="dd pd">[Optional] Specify the names of the Vertices columns to copy to the community Vertices table.</dd><dd class="dd pd ddexpand">Default behavior: The function copies the <var class="keyword varname">vertex_key</var> columns to the output Vertices table for each vertex, changing the column names to <var class="keyword varname">id</var>, <var class="keyword varname">id</var>_1, <var class="keyword varname">id</var>_2, and so on.</dd></dl></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="ztq1507756971124" xml:lang="en-us" lang="en-us" id="ztq1507756971124">
<h2 class="title topictitle2" id="ariaid-title6">Modularity Input</h2><div class="body refbody"><div class="section" id="ztq1507756971124__section_N1000E_N1000C_N10001"><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ztq1507756971124__table_yjx_22r_ycb" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d93182e570" rowspan="1" colspan="1">Table</th><th class="entry cellrowborder" style="vertical-align:top;" id="d93182e572" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e570" rowspan="1" colspan="1">Vertices</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e572" rowspan="1" colspan="1">Each row represents a vertex of the graph.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e570" rowspan="1" colspan="1">Edges</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e572" rowspan="1" colspan="1">Each row represents an edge of the graph.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e570" rowspan="1" colspan="1">Sources</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e572" rowspan="1" colspan="1">[Optional] Specifies vertices to use as sources. This table is a subset of the Vertices table. If you specify this table, the function uses only the nodes in this table as sources.</td></tr></tbody></table></div></div><div class="section" id="ztq1507756971124__section_z4r_r2r_ycb">
<h3 class="title sectiontitle">Vertices Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ztq1507756971124__table_N10017_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e600" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e602" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d93182e604" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e600" rowspan="1" colspan="1"><var class="keyword varname">vertex_key_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e602" rowspan="1" colspan="1">Any allowed in PARTITION BY clause</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e604" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">vertex_key_column</var>.] All or part of unique vertex key. Cannot be NULL.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e600" rowspan="1" colspan="1"><var class="keyword varname">accumulate_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e602" rowspan="1" colspan="1">Any</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e604" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">accumulate_column</var>.] Column to copy to community Vertices table.</td></tr></tbody></table></div></div><div class="section" id="ztq1507756971124__section_vzs_s2r_ycb">
<h3 class="title sectiontitle">Edges Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ztq1507756971124__table_N1005A_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e639" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e641" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d93182e643" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e639" rowspan="1" colspan="1"><var class="keyword varname">source_vertex_key_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e641" rowspan="1" colspan="1">Any allowed in PARTITION BY clause</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e643" rowspan="1" colspan="1">Column appears once for each specified <var class="keyword varname">source_vertex_key_column</var>.] All or part of key that identifies source vertex of edge. Must be a <var class="keyword varname">vertex_key_column</var> in Vertices table. Cannot be NULL.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e639" rowspan="1" colspan="1"><var class="keyword varname">target_key_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e641" rowspan="1" colspan="1">Same as <var class="keyword varname">source_vertex_key_column</var></td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e643" rowspan="1" colspan="1">Column appears once for each specified <var class="keyword varname">target_key_column</var>.] All or part of key that identifies target vertex of edge. Must be a <var class="keyword varname">vertex_key_column</var> in Vertices table. Can be NULL.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e639" rowspan="1" colspan="1"><var class="keyword varname">edge_weight</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e641" rowspan="1" colspan="1">SMALLINT, INTEGER, or NUMERIC</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e643" rowspan="1" colspan="1">[Required only for weighted graph.] Edge weight, a positive value. Can be NULL.</td></tr></tbody></table></div></div><div class="section" id="ztq1507756971124__section_gxx_t2r_ycb">
<h3 class="title sectiontitle">Sources Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ztq1507756971124__table_N100AB_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e694" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e696" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d93182e698" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e694" rowspan="1" colspan="1"><var class="keyword varname">source_vertex_key_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e696" rowspan="1" colspan="1">Same as corresponding <var class="keyword varname">vertex_key_column</var> in Vertices table</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e698" rowspan="1" colspan="1">Column appears once for each specified <var class="keyword varname">source_vertex_key_column</var>.] All or part of key that identifies source vertex of edge. Must be a <var class="keyword varname">vertex_key_column</var> in Vertices table. Cannot be NULL.</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title7" topicindex="7" topicid="gbx1507756906685" xml:lang="en-us" lang="en-us" id="gbx1507756906685">
<h2 class="title topictitle2" id="ariaid-title7">Modularity Output</h2><div class="body refbody"><div class="section" id="gbx1507756906685__section_g5f_bdr_ycb"><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="gbx1507756906685__table_wz3_cdr_ycb" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d93182e734" rowspan="1" colspan="1">Table</th><th class="entry cellrowborder" style="vertical-align:top;" id="d93182e736" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e734" rowspan="1" colspan="1">Community vertex table</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e736" rowspan="1" colspan="1">Has a row of modularity results for each specified resolution level.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e734" rowspan="1" colspan="1">CommunityEdgeTable</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e736" rowspan="1" colspan="1">[Optional] Contains edge weights (strengths) between different communities at specified resolutions. 
<p class="p">Function creates this table on database but does not display it as output. To display this table, use command <code class="ph codeph">SELECT * FROM <var class="keyword varname">community_edge_table</var></code>.</p></td></tr></tbody></table></div></div><div class="section" id="gbx1507756906685__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">Community Vertex Table Schema (Default Resolution)</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="gbx1507756906685__table_N10017_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:23.076923076923077%" span="1"></col><col style="width:15.384615384615385%" span="1"></col><col style="width:61.53846153846154%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e766" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e768" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d93182e770" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e766" rowspan="1" colspan="1"><var class="keyword varname">accumulate_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e768" rowspan="1" colspan="1"><span>Same as in Vertices table</span></td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e770" rowspan="1" colspan="1">Column appears once for each specified <var class="keyword varname">accumulate_column</var>.] Column copied from Vertices table.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e766" rowspan="1" colspan="1">resolution</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e768" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e770" rowspan="1" colspan="1">Resolution at which modularity score is computed.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e766" rowspan="1" colspan="1">community_id</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e768" rowspan="1" colspan="1">VARCHAR or <span>Same as in Vertices table</span></td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e770" rowspan="1" colspan="1">Identifier of community to which vertex belongs.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e766" rowspan="1" colspan="1">num_communities</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e768" rowspan="1" colspan="1">INTEGER</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e770" rowspan="1" colspan="1">Number of communities at this resolution. (Same for each resolution level.)</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e766" rowspan="1" colspan="1">modularity_score</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e768" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e770" rowspan="1" colspan="1">Modularity score at this resolution. (Same for each resolution level.)</td></tr></tbody></table></div></div><div class="section" id="gbx1507756906685__section_umc_tcr_ycb">
<h3 class="title sectiontitle">CommunityEdgeTable Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="gbx1507756906685__table_N10094_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:28.57142857142857%" span="1"></col><col style="width:14.285714285714285%" span="1"></col><col style="width:57.14285714285714%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e825" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e827" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d93182e829" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e825" rowspan="1" colspan="1">src_community_id</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e827" rowspan="1" colspan="1"><span>Same as in Vertices table</span> or VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e829" rowspan="1" colspan="1">Identifier of first community of edge.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e825" rowspan="1" colspan="1">target_community_id</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e827" rowspan="1" colspan="1"><span>Same as in Vertices table</span> or VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e829" rowspan="1" colspan="1">Identifier of second community of edge.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e825" rowspan="1" colspan="1">resolution</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e827" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e829" rowspan="1" colspan="1">Resolution at which modularity score is computed.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e825" rowspan="1" colspan="1">weight</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e827" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e829" rowspan="1" colspan="1">Strength of link from first community to second community.</td></tr></tbody></table></div></div></div></div><div class="topic concept nested1" aria-labelledby="ariaid-title8" topicindex="8" topicid="ssw1510708489206" xml:lang="en-us" lang="en-us" id="ssw1510708489206">
<h2 class="title topictitle2" id="ariaid-title8">Modularity Examples</h2><div class="topic reference nested2" aria-labelledby="ariaid-title9" topicindex="9" topicid="kvu1507757175603" xml:lang="en-us" lang="en-us" id="kvu1507757175603">
<h3 class="title topictitle3" id="ariaid-title9">Modularity Examples Input</h3><div class="body refbody"><div class="section" id="kvu1507757175603__section_N1000E_N1000C_N10001">
<p class="p">The examples use a graph in which nodes represent persons who are geographically distributed across the United States and are connected on an online social network, where they follow each other. The directed edges start at the follower and end at the leader. For example, Alex follows Bob and Casey.</p><div class="fig fignone" id="kvu1507757175603__fig_N10014_N1000E_N1000C_N10001"><div class="caption"><span>Graph of Social Network</span></div><br clear="none"></br><img class="image" id="kvu1507757175603__image_bc1_5cf_lw" src="obo1466005795036.svg" alt="Graph of input for examples of Machine Learning Engine function Modularity"></img><br clear="none"></br></div>
<p class="p">The graph in the figure is represented by the Vertices and Edges tables friends and followers_leaders, respectively. The Edges table column intensity represents the fervor with which the follower follows the leader, on a scale from 1 (lowest) to 10 (highest).</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="kvu1507757175603__table_N10026_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"><span>Vertices: friends</span></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e909" rowspan="1" colspan="1">friends_name</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e911" rowspan="1" colspan="1">location</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d93182e913" rowspan="1" colspan="1">group_id</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e909" rowspan="1" colspan="1">Alex</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e911" rowspan="1" colspan="1">SanFrancisco</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e913" rowspan="1" colspan="1">SanFrancisco</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e909" rowspan="1" colspan="1">Bob</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e911" rowspan="1" colspan="1">LosAngeles</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e913" rowspan="1" colspan="1">LosAngeles</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e909" rowspan="1" colspan="1">Casey</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e911" rowspan="1" colspan="1">LosAngeles</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e913" rowspan="1" colspan="1">LosAngeles</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e909" rowspan="1" colspan="1">Danny</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e911" rowspan="1" colspan="1">NewYorkCity</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e913" rowspan="1" colspan="1">NewYorkCity</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e909" rowspan="1" colspan="1">Eve</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e911" rowspan="1" colspan="1">Birmingham</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e913" rowspan="1" colspan="1">Birmingham</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e909" rowspan="1" colspan="1">Fox</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e911" rowspan="1" colspan="1">Austin</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e913" rowspan="1" colspan="1">Austin</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e909" rowspan="1" colspan="1">Gohar</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e911" rowspan="1" colspan="1">Miami</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e913" rowspan="1" colspan="1">Miami</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e909" rowspan="1" colspan="1">Harry</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e911" rowspan="1" colspan="1">Chicago</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e913" rowspan="1" colspan="1">Chicago</td></tr></tbody></table></div><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="kvu1507757175603__table_N100BD_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"><span>Edges: followers_leaders</span></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e981" rowspan="1" colspan="1">follower</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93182e983" rowspan="1" colspan="1">leader</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d93182e985" rowspan="1" colspan="1">intensity</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e981" rowspan="1" colspan="1">Alex</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e983" rowspan="1" colspan="1">Bob</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e985" rowspan="1" colspan="1">5</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e981" rowspan="1" colspan="1">Alex</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e983" rowspan="1" colspan="1">Casey</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e985" rowspan="1" colspan="1">6</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e981" rowspan="1" colspan="1">Casey</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e983" rowspan="1" colspan="1">Bob</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e985" rowspan="1" colspan="1">1</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e981" rowspan="1" colspan="1">Eve</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e983" rowspan="1" colspan="1">Danny</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e985" rowspan="1" colspan="1">9</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e981" rowspan="1" colspan="1">Fox</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e983" rowspan="1" colspan="1">Danny</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e985" rowspan="1" colspan="1">7</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e981" rowspan="1" colspan="1">Fox</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e983" rowspan="1" colspan="1">Eve</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e985" rowspan="1" colspan="1">8</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e981" rowspan="1" colspan="1">Gohar</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e983" rowspan="1" colspan="1">Casey</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e985" rowspan="1" colspan="1">10</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e981" rowspan="1" colspan="1">Harry</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93182e983" rowspan="1" colspan="1">Gohar</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d93182e985" rowspan="1" colspan="1">4</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e981" rowspan="1" colspan="1">Harry</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93182e983" rowspan="1" colspan="1">Danny</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d93182e985" rowspan="1" colspan="1">3</td></tr></tbody></table></div></div></div></div><div class="topic reference nested2" aria-labelledby="ariaid-title10" topicindex="10" topicid="phm1507757284733" xml:lang="en-us" lang="en-us" id="phm1507757284733">
<h3 class="title topictitle3" id="ariaid-title10">Modularity Example: Unweighted Edges</h3><div class="body refbody"><div class="section" id="phm1507757284733__section_t5m_m4x_xhb">
<h4 class="title sectiontitle">Input</h4>
<p class="p">See <a href="wni1558459753903.md#kvu1507757175603">Modularity Examples Input</a>.</p></div><div class="section" id="phm1507757284733__section_N10011_N1000E_N10001">
<p class="p">Followers follow leaders with equal intensity (all edges have default weight 1).</p></div><div class="section" id="phm1507757284733__section_f42_ghg_5db">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM Modularity (
  ON friends AS Vertices PARTITION BY friends_name
  ON followers_leaders AS Edges PARTITION BY follower
  OUT TABLE CommunityEdgeTable (community_edges)
  USING
  TargetKey ('leader')
  CommunityAssociation ('group_id')
  Accumulate ('friends_name','location')
) AS dt ORDER BY friends_name;</code></pre></div><div class="section" id="phm1507757284733__section_a2s_ghg_5db">
<h4 class="title sectiontitle">Output</h4><pre class="pre screen" xml:space="preserve"> friends_name location      resolution community_id num_communities modularity_score    
 ------------ ------------- ---------- ------------ --------------- ------------------- 
 alex         san francisco        1.0 los angeles                3 0.42592594027519226
 bob          los angeles          1.0 los angeles                3 0.42592594027519226
 casey        los angeles          1.0 los angeles                3 0.42592594027519226
 danny        new york city        1.0 austin                     3 0.42592594027519226
 eve          birmingham           1.0 austin                     3 0.42592594027519226
 fox          austin               1.0 austin                     3 0.42592594027519226
 gohar        miami                1.0 chicago                    3 0.42592594027519226
 harry        chicago              1.0 chicago                    3 0.42592594027519226</pre><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM community_edges ORDER BY src_community_id, target_community_id;</code></pre><pre class="pre screen" xml:space="preserve"> src_community_id target_community_id resolution weight 
 ---------------- ------------------- ---------- ------ 
 austin           austin                     1.0    6.0
 austin           chicago                    1.0    1.0
 chicago          austin                     1.0    1.0
 chicago          chicago                    1.0    2.0
 chicago          los angeles                1.0    1.0
 los angeles      chicago                    1.0    1.0
 los angeles      los angeles                1.0    6.0</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div><div class="topic reference nested2" aria-labelledby="ariaid-title11" topicindex="11" topicid="mha1507757630551" xml:lang="en-us" lang="en-us" id="mha1507757630551">
<h3 class="title topictitle3" id="ariaid-title11">Modularity Example: Weighted Edges, Community Edge Table</h3><div class="body refbody"><div class="section" id="mha1507757630551__section_dpz_44x_xhb">
<h4 class="title sectiontitle">Input</h4>
<p class="p">See <a href="wni1558459753903.md#kvu1507757175603">Modularity Examples Input</a>.</p></div><div class="section" id="mha1507757630551__section_N10011_N1000E_N10001">
<p class="p">Followers follow leaders with different intensity.</p></div><div class="section" id="mha1507757630551__section_f42_ghg_5db">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM Modularity (
  ON friends AS Vertices PARTITION BY friends_name
  ON followers_leaders AS Edges PARTITION BY follower
  OUT TABLE CommunityEdgeTable (community_edges)
  USING
  TargetKey ('leader')
  CommunityAssociation ('group_id')
  EdgeWeight ('intensity')
  Accumulate ('friends_name','location')
) AS dt ORDER BY friends_name;</code></pre></div><div class="section" id="mha1507757630551__section_a2s_ghg_5db">
<h4 class="title sectiontitle">Output</h4><pre class="pre screen" xml:space="preserve"> friends_name location      resolution community_id num_communities modularity_score    
 ------------ ------------- ---------- ------------ --------------- ------------------- 
 alex         san francisco        1.0 los angeles                2 0.44268423318862915
 bob          los angeles          1.0 los angeles                2 0.44268423318862915
 casey        los angeles          1.0 los angeles                2 0.44268423318862915
 danny        new york city        1.0 birmingham                 2 0.44268423318862915
 eve          birmingham           1.0 birmingham                 2 0.44268423318862915
 fox          austin               1.0 birmingham                 2 0.44268423318862915
 gohar        miami                1.0 los angeles                2 0.44268423318862915
 harry        chicago              1.0 los angeles                2 0.44268423318862915</pre><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM community_edges ORDER BY src_community_id, target_community_id;</code></pre><pre class="pre screen" xml:space="preserve"> src_community_id target_community_id resolution weight 
 ---------------- ------------------- ---------- ------ 
 birmingham       birmingham                 1.0   48.0
 birmingham       los angeles                1.0    3.0
 los angeles      birmingham                 1.0    3.0
 los angeles      los angeles                1.0   52.0</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title12" topicindex="12" topicid="znm1507758586853" xml:lang="en-us" lang="en-us" id="znm1507758586853">
<h2 class="title topictitle2" id="ariaid-title12">Modularity Tips</h2><div class="body refbody"><div class="section" id="znm1507758586853__section_N10011_N1000E_N10001">
<ul class="ul">
<li class="li">If the modularity when you specify multiple resolution points in the Resolution syntax element differs from the modularity for the same resolution points when you specify them individually, Teradata recommends specifying the resolution points individually.</li>
<li class="li">The function runs faster on graphs with vertices of data type INTEGER or BIGINT, because they use less memory than graphs with vertices of other data types.
<p class="p">Suppose that you have Vertices table string_nodes with column id of data type VARCHAR and Edges table string_edges with columns src_id, dest_id, and weight of data types VARCHAR, VARCHAR, and INTEGER, respectively. You can create equivalent INTEGER-based vertex and Edges tables statements such as these:</p><pre class="pre codeblock" xml:space="preserve"><code>CREATE MULTISET TABLE int_nodes (id_string VARCHAR, id_int INTEGER);

INSERT INTO int_nodes SELECT id, row_number()
  OVER (ORDER BY id) FROM string_nodes;

CREATE MULTISET TABLE int_edges (src INTEGER, dest INTEGER, weight INTEGER) AS (
  SELECT m1.id_int, m2.id_int, weight
  FROM string_edges E, int_nodes m1, int_nodes m2
  WHERE E.src_id = m1.id_string AND E.dest_id = m2.id_string
) WITH DATA;</code></pre></li>
<li class="li">If the column community_id that the function creates has data type VARCHAR, and you want community_id to have the data type INTEGER, use either of the these statements (where the table modularity_output is output by the function):<pre class="pre codeblock" xml:space="preserve"><code>SELECT id, rank() OVER (ORDER BY community_id) AS comm_int_id
  FROM <var class="keyword varname">modularity_output</var>;

SELECT id, dense_rank() OVER (ORDER BY community_id) AS comm_int_id
  FROM <var class="keyword varname">modularity_output</var>;</code></pre></li></ul></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title13" topicindex="13" topicid="pgt1518210660607" xml:lang="en-us" lang="en-us" id="pgt1518210660607">
<h2 class="title topictitle2" id="ariaid-title13">Modularity Troubleshooting</h2><div class="body refbody"><div class="section" id="pgt1518210660607__section_N10011_N1000E_N10001">
<h3 class="title sectiontitle">Problem: Function runs slowly for large graphs or terminates unsuccessfully.</h3>
<p class="p">If the function terminates unsuccessfully, it displays a failure message.</p></div><div class="section" id="pgt1518210660607__section_z1g_m1v_5cb">
<h3 class="title sectiontitle">Workarounds:</h3>
<ul class="ul" id="pgt1518210660607__ul_pct_2vz_51b">
<li class="li">Consult the logs for error message details and troubleshooting.</li>
<li class="li">The logs can help determine the time taken for each iteration. If you know the number of iterations that the function takes (usually 25-50), you can estimate the total execution time.</li>
<li class="li">All graph functions operate much faster on INTEGER and BIGINT single-column vertex ids. To create an INTEGER vertex based graph, see <a href="wni1558459753903.md#znm1507758586853">Modularity Tips</a>.</li>
<li class="li">Compute the modularity in incremental steps by choosing a subset of nodes using the Sources syntax element.</li>
<li class="li">If you know some groupings in the graph, specify them with the CommunityAssociation syntax element.</li>
<li class="li">If you specified the CommunityEdgeTable syntax element, the reason for slowness might be that the function is writing the community table to the database through JDBC. Run the function without the CommunityEdgeTable syntax element first, to obtain the modularity of the resultant graph.</li></ul></div><div class="section" id="pgt1518210660607__section_ghq_n1v_5cb">
<h3 class="title sectiontitle">Problem: Function terminates with errors on Vertices table or Edges table.</h3></div><div class="section" id="pgt1518210660607__section_myx_n1v_5cb">
<h3 class="title sectiontitle">Workarounds:</h3>
<ul class="ul" id="pgt1518210660607__ul_jxg_svz_51b">
<li class="li">Consult the logs for error message details and troubleshooting.</li>
<li class="li">Verify that all source and target Vertices in the Edges table are listed in the Vertices table.</li>
<li class="li">Verify that the columns representing source and target vertices are not NULL.</li></ul></div><div class="section" id="pgt1518210660607__section_tkh_41v_5cb">
<h3 class="title sectiontitle">Problem: Function completes successfully but results are poor.</h3>
<p class="p">Results do not show good modularity or community detection.</p></div><div class="section" id="pgt1518210660607__section_dt4_41v_5cb">
<h3 class="title sectiontitle">Workarounds:</h3>
<ul class="ul" id="pgt1518210660607__ul_ah4_2wz_51b">
<li class="li">Change the value of seed.</li>
<li class="li">Multiply the edge weights by a constant.</li>
<li class="li">Change the values in the Resolution syntax element.</li>
<li class="li">If you know some groupings in the graph, specify them with the CommunityAssociation syntax element.</li></ul>
<p class="p">A poor modularity score can indicate that the graph has no inherent community structure.</p></div></div></div></div></body></html>
