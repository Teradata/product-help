<html><head></head><body><div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="bhu1507815860164" id="bhu1507815860164"><h1 class="title topictitle1" id="ariaid-title1">GTree (ML Engine)</h1><div class="body conbody">
<p class="p">The GTree function follows all paths in a graph, starting from a given set of root vertices, and calculates specified aggregate functions along those paths.</p>
<p class="p">The GTree function is similar to the function <a href="bhm1558544690966.md#vcy1507767993321">NTree (ML Engine)</a>, but GTree is implemented using the <span><b>SQL-GR</b></span> engine. The <span><b>SQL-GR</b></span> engine allows the GTree function to traverse arbitrary graphs.</p>
<p class="p">Some information in NTree syntax elements is input to the GTree function differently, as the following table shows.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="bhu1507815860164__table_N1001D_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"><span>GTree Analogs of NTree Syntax Elements</span></div><colgroup span="1"><col style="width:12.5%" span="1"></col><col style="width:87.5%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e59" rowspan="1" colspan="1">SQL-MR Function NTree Syntax Element</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d275090e61" rowspan="1" colspan="1">SQL-GR Function GTree Analog</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e59" rowspan="1" colspan="1">Root_Node</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e61" rowspan="1" colspan="1">GTree gets the root nodes of the trees from the input table root.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e59" rowspan="1" colspan="1">Node_ID</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e61" rowspan="1" colspan="1">GTree gets the nodes from the partition keys for the input tables vertices, edges, and root. The name of these keys can differ, but each partition must have the same number of keys and corresponding keys must have the same data type.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e59" rowspan="1" colspan="1">Parent_ID</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e61" rowspan="1" colspan="1">The input table edges and the TargetKey syntax element define the parent ID. If the TargetKey specifies a vertex, then GTree finds its parent in the corresponding partition key entries.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e59" rowspan="1" colspan="1">Mode</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e61" rowspan="1" colspan="1">To change the direction in which GTree traverses the graph, reverse the direction of the edges by switching the columns in the edges table partition key with the columns specified by the TargetKey syntax element.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e59" rowspan="1" colspan="1">Result</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e61" rowspan="1" colspan="1">GTree gets the aggregate functions and their aliases from its Results syntax element, which is similar to the NTree Result syntax element. However, the parser that GTree uses requires that you enclose each aggregate function and its alias in quotation marks.</td></tr></tbody></table></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="oms1507815947102" xml:lang="en-us" lang="en-us" id="oms1507815947102">
<h2 class="title topictitle2" id="ariaid-title2">GTree Syntax</h2><div class="body refbody"><div class="section" id="oms1507815947102__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">Version <span>1.4</span></h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM GTree (
  ON <var class="keyword varname">vertices_table</var> AS Vertices PARTITION BY <var class="keyword varname">vertex_key_column</var> [,...] 
  ON <var class="keyword varname">edges_table</var> AS Edges PARTITION BY <var class="keyword varname">source_vertex_key_column</var> [,...] 
  <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> AS Root PARTITION BY <var class="keyword varname">root_key_column</var>
  USING
  TargetKey ({ '<var class="keyword varname">edges_column</var>' | <var class="keyword varname">edges_column_range</var> }[,...])
  [ AllowCycles (<span><b>{'true'|'t'|'yes'|'y'|'1'|'false'|'f'|'no'|'n'|'0'}</b></span>) ]
  [ MaxDepth (<var class="keyword varname">max_depth</var>) ]
  [ OutputType ({ 'all' | 'end' }) ]
  { Results ('<var class="keyword varname">func</var>(<var class="keyword varname">expr</var>) [ AS <var class="keyword varname">alias</var>]' [,...]) ] | EdgeResults ('<var class="keyword varname">func</var>(<var class="keyword varname">expr</var>) [ AS <var class="keyword varname">alias</var>]' [,...])) }
  [ FinalEdgeFlag (<span><b>{'true'|'t'|'yes'|'y'|'1'|'false'|'f'|'no'|'n'|'0'}</b></span>)]
) AS <var class="keyword varname">alias</var>;</code></pre></div></div><div class="related-links"><div class="linklistheader"><p></p><b>Related Information</b></div>
<ul class="linklist linklist relinfo"><div class="linklistmember"><a href="ndv1557782188375.md">Column Specification Syntax Elements</a></div></ul></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="rpp1507816020404" xml:lang="en-us" lang="en-us" id="rpp1507816020404">
<h2 class="title topictitle2" id="ariaid-title3">GTree Syntax Elements</h2><div class="body refbody"><div class="section" id="rpp1507816020404__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">TargetKey</dt><dd class="dd pd">Specify the names of the columns in the Edges table that identify the target vertex of an edge.</dd><dt class="dt pt dlterm">AllowCycles</dt><dd class="dd pd">[Optional] Specify whether the input graph can include cycles.</dd><dd class="dd pd ddexpand">Default: 'false'</dd><dt class="dt pt dlterm">MaxDepth</dt><dd class="dd pd">[Optional] Specify the maximum depth to which the function traverses the graph (a nonnegative integer).</dd><dd class="dd pd ddexpand">Default: 1000</dd><dt class="dt pt dlterm">OutputType</dt><dd class="dd pd">[Optional] Specify whether the function outputs all paths ('all') or only paths that end by reaching a leaf vertex, a cycle, or the maximum number of iterations ('end').</dd><dd class="dd pd ddexpand">Default: 'end'</dd><dt class="dt pt dlterm">Results</dt><dd class="dd pd">[Required if you omit EdgeResults.] Specify the aggregate functions to calculate along each vertex in each path (see the following table). The function outputs a results column for each aggregate function. The column name is <var class="keyword varname">alias</var>, if specified; otherwise it is <var class="keyword varname">func</var>(<var class="keyword varname">expr</var>).</dd><dt class="dt pt dlterm">EdgeResults</dt><dd class="dd pd">[Required if you omit Results.] Specify the aggregate functions to calculate along each edge in each path (see the following table). The function outputs a results column for each aggregate function. The column name is <var class="keyword varname">alias</var>, if specified; otherwise it is <var class="keyword varname">func</var>(<var class="keyword varname">expr</var>).</dd><dt class="dt pt dlterm">FinalEdgeFlag</dt><dd class="dd pd">[Optional] Specify whether to include the edge that follows the final vertex when calculating the functions that EdgeResults specifies.</dd><dd class="dd pd ddexpand">Default: 'true'</dd></dl></div><div class="section" id="rpp1507816020404__section_thv_msz_fdb">
<h3 class="title sectiontitle">Aggregate Functions Supported by GTree Function</h3>
<p class="p">The following table describes the aggregate functions that the Results and EdgeResults syntax elements support. In function syntax, expr, expr1, and expr2 are values from the Vertices or Edges table.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="rpp1507816020404__table_N1009A_N10094_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:2.12037in" span="1"></col><col style="width:3.23147in" span="1"></col><col style="width:1.64815in" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e291" rowspan="1" colspan="1">Aggregate Function</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e293" rowspan="1" colspan="1">Description</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d275090e295" rowspan="1" colspan="1">Return Value Data Type</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">correl(<var class="keyword varname">expr1</var>, <var class="keyword varname">expr2</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns Pearson product-moment correlation between <var class="keyword varname">expr1</var> and <var class="keyword varname">expr2</var> on path.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">DOUBLE PRECISION</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">count(<var class="keyword varname">expr</var> [,...])</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns number of vertices in path where no <var class="keyword varname">expr</var> is null.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">INTEGER</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">countdistinct(<var class="keyword varname">expr</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns number of distinct values of <var class="keyword varname">expr</var> in vertices on path.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">INTEGER</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">current(<var class="keyword varname">expr</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns value of <var class="keyword varname">expr</var> at final vertex in path.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">Same as input</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">cycle()</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns '1' if GTree function ends path by completing a cycle (that is, by visiting a vertex a second time), '0' otherwise.<div class="note note" id="rpp1507816020404__note_N10117_N10113_N1010D_N100BF_N100A0_N1009A_N10094_N1000C_N10001"><span><b>Note</b></span><div class="notebody">Specify this function only in EdgeResults syntax element.</div></div></td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">BYTEINT</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">histogram(<var class="keyword varname">expr</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns a JSON string that contains counts of each distinct value of expr on path.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">VARCHAR</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">leaf()</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns '1' if GTree function ends path by reaching a leaf vertex (that is, a vertex with no outgoing edges), '0' otherwise.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">BYTEINT</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">level()</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns number of vertices on path from root vertex to last visited vertex.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">INTEGER</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">max(<var class="keyword varname">expr</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns maximum value of expr over all vertices from root vertex to last visited vertex.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">Same as input</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">maxiteration()</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns '1' if GTree function ends path by reaching maximum number of iterations specified by MaxDepth syntax element, '0' otherwise.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">BYTEINT</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">mean(<var class="keyword varname">expr</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns mean value of <var class="keyword varname">expr</var> over all vertices from root vertex to last visited vertex.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">DOUBLE PRECISION</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">min(<var class="keyword varname">expr</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns minimum value of <var class="keyword varname">expr</var> over all vertices from root vertex to last visited vertex.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">Same as input</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">path(<var class="keyword varname">expr</var>[,...])</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns a string that represents path from root vertex to last visited vertex. string has form 'v1->v2->v3...' for a vertex path and '.-v1->.-v2->.-v3->...' for an edge path, where v<var class="keyword varname">n</var> is value of <var class="keyword varname">n</var>th <var class="keyword varname">expr</var>.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">CLOB</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">propagate(<var class="keyword varname">expr</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns value of <var class="keyword varname">expr</var> at root vertex.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">Same as input</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">range(<var class="keyword varname">expr</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns difference between minimum and maximum values of <var class="keyword varname">expr</var> on path (max(<var class="keyword varname">expr</var>) - min(<var class="keyword varname">expr</var>)).</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">Same as input</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">stdev(<var class="keyword varname">expr</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns standard deviation of expr over all vertices from root vertex to last visited vertex.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">DOUBLE PRECISION</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">sum(<var class="keyword varname">expr</var>)</code></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Returns sum of <var class="keyword varname">expr</var> over all vertices from root vertex to last visited vertex.</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">Same as input</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e291" rowspan="1" colspan="1"><code class="ph codeph">sumproduct(<var class="keyword varname">expr1</var>, <var class="keyword varname">expr2</var>)</code></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e293" rowspan="1" colspan="1">Calculates product of <var class="keyword varname">expr1</var> and <var class="keyword varname">expr2</var> at each vertex on path and then returns sum of products.</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e295" rowspan="1" colspan="1">Same as input if <var class="keyword varname">expr1</var> and <var class="keyword varname">expr2</var> have same type, otherwise NUMERIC</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="lfi1507816096285" xml:lang="en-us" lang="en-us" id="lfi1507816096285">
<h2 class="title topictitle2" id="ariaid-title4">GTree Input</h2><div class="body refbody"><div class="section" id="lfi1507816096285__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">Vertices Schema</h3>
<p class="p">Each row represents a vertex of the graph.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="lfi1507816096285__table_N1001F_N1001C_N10014_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:25%" span="1"></col><col style="width:37.5%" span="1"></col><col style="width:37.5%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e574" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e576" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d275090e578" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e574" rowspan="1" colspan="1"><var class="keyword varname">vertex_key_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e576" rowspan="1" colspan="1">Any allowed in PARTITION BY clause</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e578" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">vertex_key_column</var>.] All or part of unique vertex key. Cannot be NULL.</td></tr></tbody></table></div></div><div class="section" id="lfi1507816096285__section_t52_t5l_ycb">
<h3 class="title sectiontitle">Edges Schema</h3>
<p class="p">Each row represents an edge of the graph.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="lfi1507816096285__table_N10070_N1001C_N10014_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:18.181818181818183%" span="1"></col><col style="width:27.27272727272727%" span="1"></col><col style="width:54.54545454545454%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e604" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e606" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d275090e608" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e604" rowspan="1" colspan="1"><var class="keyword varname">source_vertex_key_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e606" rowspan="1" colspan="1">Any allowed in PARTITION BY clause</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e608" rowspan="1" colspan="1">Column appears once for each specified <var class="keyword varname">source_vertex_key_column</var>.] All or part of key that identifies source vertex of edge. Must be a <var class="keyword varname">vertex_key_column</var> in Vertices table. Cannot be NULL.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e604" rowspan="1" colspan="1"><var class="keyword varname">target_vertex_key_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d275090e606" rowspan="1" colspan="1">Same as <var class="keyword varname">source_vertex_key_column</var></td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d275090e608" rowspan="1" colspan="1">Column appears once for each specified <var class="keyword varname">target_vertex_key_column</var>.] All or part of key that identifies target vertex of edge. Must be a <var class="keyword varname">vertex_key_column</var> in Vertices table. Cannot be NULL.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e604" rowspan="1" colspan="1"><var class="keyword varname">edge_weight</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e606" rowspan="1" colspan="1">SMALLINT, INTEGER, or NUMERIC</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e608" rowspan="1" colspan="1">[Required only for weighted graph.] Edge weight, a positive value. Can be NULL.</td></tr></tbody></table></div></div><div class="section" id="lfi1507816096285__section_v4t_t5l_ycb">
<h3 class="title sectiontitle">Root Schema</h3>
<p class="p">Each row represents a root vertex from which the function starts traversing the graph.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="lfi1507816096285__table_N100CF_N1001C_N10014_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:18.181818181818183%" span="1"></col><col style="width:27.27272727272727%" span="1"></col><col style="width:54.54545454545454%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e661" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e663" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d275090e665" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e661" rowspan="1" colspan="1"><var class="keyword varname">root_key_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e663" rowspan="1" colspan="1">Any allowed in PARTITION BY clause</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e665" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">root_key_column</var>.] All or part of root vertex key. Must be a <var class="keyword varname">vertex_key_column</var> in Vertices table. Cannot be NULL.</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="exy1507816391489" xml:lang="en-us" lang="en-us" id="exy1507816391489">
<h2 class="title topictitle2" id="ariaid-title5">GTree Output</h2><div class="body refbody"><div class="section" id="exy1507816391489__section_zjn_45l_ycb">
<h3 class="title sectiontitle">Output Table Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="exy1507816391489__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:19.047619047619047%" span="1"></col><col style="width:23.809523809523807%" span="1"></col><col style="width:57.14285714285714%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e701" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d275090e703" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d275090e705" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e701" rowspan="1" colspan="1"><var class="keyword varname">alias</var> if specified, otherwise <var class="keyword varname">func</var>(<var class="keyword varname">expr</var>)</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d275090e703" rowspan="1" colspan="1">Type returned by aggregate function (see <a href="ngy1558544263564.md#rpp1507816020404">GTree Syntax Elements</a>)</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e705" rowspan="1" colspan="1">[Column appears once for each specified aggregate function.] Result of aggregate function.</td></tr></tbody></table></div></div></div></div><div class="topic concept nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="tpd1510708197596" xml:lang="en-us" lang="en-us" id="tpd1510708197596">
<h2 class="title topictitle2" id="ariaid-title6">GTree Examples</h2><div class="topic reference nested2" aria-labelledby="ariaid-title7" topicindex="7" topicid="xhr1526063998718" xml:lang="en-us" lang="en-us" id="xhr1526063998718">
<h3 class="title topictitle3" id="ariaid-title7">GTree Example: All Paths from Root Nodes</h3><div class="body refbody"><div class="section" id="xhr1526063998718__section_ydy_tb2_ygb">
<p class="p">This example shows all paths from root nodes.</p></div><div class="section" id="xhr1526063998718__section_hb5_rkr_t2b">
<h4 class="title sectiontitle">Input</h4>
<p class="p">The vertices (nodes) are bus stops in a small town. The Vertices table lists each bus stop and the boarding fare at that stop.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="xhr1526063998718__table_bdr_tkr_t2b" class="table" frame="border" border="1" rules="all"><div class="caption"><span>Vertices: gtree_vertices</span></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d275090e774" rowspan="1" colspan="1">nodeid</th><th class="entry cellrowborder" style="vertical-align:top;" id="d275090e776" rowspan="1" colspan="1">nodestring</th><th class="entry cellrowborder" style="vertical-align:top;" id="d275090e778" rowspan="1" colspan="1">value</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e774" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e776" rowspan="1" colspan="1">Park St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e778" rowspan="1" colspan="1">2.25</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e774" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e776" rowspan="1" colspan="1">Main St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e778" rowspan="1" colspan="1">2.25</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e774" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e776" rowspan="1" colspan="1">Walnut St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e778" rowspan="1" colspan="1">2.25</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e774" rowspan="1" colspan="1">4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e776" rowspan="1" colspan="1">Water St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e778" rowspan="1" colspan="1">3.5</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e774" rowspan="1" colspan="1">5</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e776" rowspan="1" colspan="1">High St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e778" rowspan="1" colspan="1">2.25</td></tr></tbody></table></div>
<p class="p">The Edges table represents the bus route. The columns nodeid and nodestring identify the source vertices (where the bus starts) and the columns endnodeid and endnodestring identify the target vertices (where the bus stops).</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="xhr1526063998718__table_acd_ykr_t2b" class="table" frame="border" border="1" rules="all"><div class="caption"><span>Edges: gtree_edges</span></div><colgroup span="1"><col style="width:25%" span="1"></col><col style="width:25%" span="1"></col><col style="width:25%" span="1"></col><col style="width:25%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d275090e828" rowspan="1" colspan="1">nodeid</th><th class="entry cellrowborder" style="vertical-align:top;" id="d275090e830" rowspan="1" colspan="1">nodestring</th><th class="entry cellrowborder" style="vertical-align:top;" id="d275090e832" rowspan="1" colspan="1">endnodeid</th><th class="entry cellrowborder" style="vertical-align:top;" id="d275090e834" rowspan="1" colspan="1">endnodestring</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e828" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e830" rowspan="1" colspan="1">Park St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e832" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e834" rowspan="1" colspan="1">Walnut St</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e828" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e830" rowspan="1" colspan="1">Main St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e832" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e834" rowspan="1" colspan="1">Walnut St</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e828" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e830" rowspan="1" colspan="1">Walnut St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e832" rowspan="1" colspan="1">4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e834" rowspan="1" colspan="1">Water St</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e828" rowspan="1" colspan="1">4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e830" rowspan="1" colspan="1">Water St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e832" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e834" rowspan="1" colspan="1">Park St</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e828" rowspan="1" colspan="1">4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e830" rowspan="1" colspan="1">Water St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e832" rowspan="1" colspan="1">5</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e834" rowspan="1" colspan="1">High St</td></tr></tbody></table></div>
<p class="p">The Root table defines the set of root vertices from which the function starts traversing the graph.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="xhr1526063998718__table_hph_dlr_t2b" class="table" frame="border" border="1" rules="all"><div class="caption"><span>Root: gtree_root</span></div><colgroup span="1"><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col><col style="width:33.33333333333333%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d275090e893" rowspan="1" colspan="1">nodeid</th><th class="entry cellrowborder" style="vertical-align:top;" id="d275090e895" rowspan="1" colspan="1">nodestring</th><th class="entry cellrowborder" style="vertical-align:top;" id="d275090e897" rowspan="1" colspan="1">value</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e893" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e895" rowspan="1" colspan="1">Park St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e897" rowspan="1" colspan="1">2.25</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e893" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e895" rowspan="1" colspan="1">Main St</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d275090e897" rowspan="1" colspan="1">2.25</td></tr></tbody></table></div></div><div class="section" id="xhr1526063998718__section_sk4_zzf_5db">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM GTree (
  ON gtree_vertices AS Vertices PARTITION BY nodeid, nodestring
  ON gtree_edges AS Edges PARTITION BY nodeid, nodestring
  ON gtree_root AS Root PARTITION BY nodeid, nodestring
  USING
  TargetKey ('endnodeid', 'endnodestring')
  AllowCycles ('t')
  MaxDepth (10)
  OutputType ('all')
  Results (
    'Propagate (nodeid) AS start_vertex',
    'Current (nodeid) AS end_vertex',
    'Path (nodestring)',
    'Sum (value1)',
    'Cycle()',
    'Leaf()'
  )
  EdgeResults ('PATH(nodestring, endnodestring) AS edgepath')
) AS dt ORDER BY 1,2;</code></pre></div><div class="section" id="xhr1526063998718__section_hsw_xzf_5db">
<h4 class="title sectiontitle">Output</h4>
<p class="p">The output table has one column for each function that the Results or EdgeResults syntax element specifies. The edgepath column shows the links that comprise the path, the cycle column shows whether the path is a cycle, and the sum column shows the total fare for the path (the sum of the boarding fares at each node in the path).</p><pre class="pre screen" xml:space="preserve"> start_vertex end_vertex path(nodestring)                               sum(value1) cycle() leaf() edgepath         
 ------------ ---------- ----------------                               ----------- ------- ------ ---------------- 
            1          1 park st->                                          2.25    false   false  .-park stwalnut st->.
            1          3 park st->walnut st->                                4.5    false   false  .-park stwalnut st->.-walnut stwater st->.
            1          4 park st->walnut st->water st->                      8.0    true    false  .-park stwalnut st->.-walnut stwater st->.-water stpark st->
            1          4 park st->walnut st->water st->                      8.0    false   false  .-park stwalnut st->.-walnut stwater st->.-water sthigh st->.
            1          5 park st->walnut st->water st->high st             10.25    false   true   .-park stwalnut st->.-walnut stwater st->.-water sthigh st->.
            2          1 main st->walnut st->water st->park st->           10.25    true    false  .-main stwalnut st->.-walnut stwater st->.-water stpark st->.-park stwalnut st->
            2          2 main st->                                          2.25    false   false  .-main stwalnut st->.
            2          3 main st->walnut st->                                4.5    false   false  .-main stwalnut st->.-walnut stwater st->.
            2          4 main st->walnut st->water st->                      8.0    false   false  .-main stwalnut st->.-walnut stwater st->.-water stpark st->.
            2          4 main st->walnut st->water st->                      8.0    false   false  .-main stwalnut st->.-walnut stwater st->.-water sthigh st->.
            2          5 main st->walnut st->water st->high st             10.25    false   true   .-main stwalnut st->.-walnut stwater st->.-water sthigh st->.</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div><div class="topic reference nested2" aria-labelledby="ariaid-title8" topicindex="8" topicid="kmd1526064031111" xml:lang="en-us" lang="en-us" id="kmd1526064031111">
<h3 class="title topictitle3" id="ariaid-title8">GTree Example: Paths That Cycle or End at Leaves</h3><div class="body refbody"><div class="section" id="kmd1526064031111__section_ydy_tb2_ygb">
<p class="p">This example shows only paths that either cycle or end at leaves.</p></div><div class="section" id="kmd1526064031111__section_gbt_hlr_t2b">
<h4 class="title sectiontitle">Input</h4>
<p class="p">Input tables are from <a href="ngy1558544263564.md#xhr1526063998718">GTree Example: All Paths from Root Nodes</a>:</p>
<ul class="ul" id="kmd1526064031111__ul_szh_3lr_t2b">
<li class="li">Vertices: gtree_vertices</li>
<li class="li">Edges: gtree_edges</li>
<li class="li">Root: gtree_root</li></ul></div><div class="section" id="kmd1526064031111__section_N10011_N1000E_N10001">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM GTree (
  ON gtree_vertices AS Vertices PARTITION BY nodeid, nodestring
  ON gtree_edges AS Edges PARTITION BY nodeid, nodestring
  ON gtree_root AS Root PARTITION BY nodeid, nodestring
  USING
  TargetKey ('endnodeid', 'endnodestring')
  AllowCycles ('t')
  MaxDepth (10)
  <span>OutputType ('end')</span> 
  Results (
    'Propagate (nodeid) AS start_vertex',
    'Current (nodeid) AS end_vertex',
    'Path (nodestring)',
    'Sum (value)',
    'Cycle()',
    'Leaf()'
  )
  EdgeResults ('PATH(nodestring, endnodestring) AS edgepath')
) AS dt ORDER BY 1,2;</code></pre></div><div class="section" id="kmd1526064031111__section_hsw_xzf_5db">
<h4 class="title sectiontitle">Output</h4><pre class="pre screen" xml:space="preserve"> start_vertex end_vertex path(nodestring)                           sum(value1) cycle() leaf() edgepath         
 ------------ ---------- ----------------                           ----------- ------- ------ ---------------- 
            1          4 park st->walnut st->water st->             8.0          true    false  .-park stwalnut st->.-walnut stwater st->.-water stpark st->
            1          5 park st->walnut st->water st->high st      10.25        false   true   .-park stwalnut st->.-walnut stwater st->.-water sthigh st->.
            2          1 main st->walnut st->water st->park st->    10.25        true    false  .-main stwalnut st->.-walnut stwater st->.-water stpark st->.-park stwalnut st->
            2          5 main st->walnut st->water st->high st      10.25        false   true   .-main stwalnut st->.-walnut stwater st->.-water sthigh st->.</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div></div></div></body></html>
