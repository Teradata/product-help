<html><head></head><body><div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="llb1507907767463" id="llb1507907767463"><h1 class="title topictitle1" id="ariaid-title1">KNNRecommenderPredict</h1><div class="body conbody"></div><div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="mhw1507907859579" xml:lang="en-us" lang="en-us" id="mhw1507907859579">
<h2 class="title topictitle2" id="ariaid-title2">KNNRecommenderPredict Syntax</h2><div class="body refbody"><div class="section" id="mhw1507907859579__section_N10024_N10021_N10001">
<h3 class="title sectiontitle">Version 1.3</h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM KNNRecommenderPredict (
  ON <var class="keyword varname">rating_table</var> AS Ratings PARTITION BY <var class="keyword varname">userid_column</var>
  ON <var class="keyword varname">weight_model_table</var> AS Weights DIMENSION
  ON <var class="keyword varname">bias_model_table</var> AS Bias DIMENSION
  [ USING
    [ UserIDColumn ('<var class="keyword varname">userid_column</var>')
      ItemIDColumn ('<var class="keyword varname">itemid_column</var>')
      RatingColumn ('<var class="keyword varname">rating_column</var>')
    ]
    [ TopK (<var class="keyword varname">top_k_recommendations</var>) ]
  ]
) AS <var class="keyword varname">alias</var>;</code></pre></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="nwt1507907864364" xml:lang="en-us" lang="en-us" id="nwt1507907864364">
<h2 class="title topictitle2" id="ariaid-title3">KNNRecommenderPredict Syntax Elements</h2><div class="body refbody"><div class="section" id="nwt1507907864364__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">UserIDColumn</dt><dd class="dd pd">[Optional] Specify the Ratings column that contains the user IDs.</dd><dd class="dd pd ddexpand">Specify either all or none of UserIDColumn, ItemIDColumn, and RatingColumn. If you specified them in the KNNRecommender call that created the weights and bias tables that the KNNRecommenderPredict call uses, specify them in the KNNRecommenderPredict call, with the same values.</dd><dd class="dd pd ddexpand">Default: First Ratings column</dd><dt class="dt pt dlterm">ItemIDColumn</dt><dd class="dd pd">[Optional] Specify the Ratings column that contains the item IDs.</dd><dd class="dd pd ddexpand">Default: Second Ratings column</dd><dt class="dt pt dlterm">RatingColumn</dt><dd class="dd pd">[Optional] Specify the Ratings column that contains the ratings.</dd><dd class="dd pd ddexpand">Default: Third Ratings column</dd><dt class="dt pt dlterm">TopK</dt><dd class="dd pd">[Optional] Specify the number of items to recommend for each user. The function recommends the <var class="keyword varname">top_k_recommendations</var> highest-rated items.</dd><dd class="dd pd ddexpand">Default: 3</dd></dl></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="euz1507907868076" xml:lang="en-us" lang="en-us" id="euz1507907868076">
<h2 class="title topictitle2" id="ariaid-title4">KNNRecommenderPredict Input</h2><div class="body refbody"><div class="section" id="euz1507907868076__section_N1000E_N1000C_N10001"><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="euz1507907868076__table_bdv_wvk_ycb" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d292771e151" rowspan="1" colspan="1">Table</th><th class="entry cellrowborder" style="vertical-align:top;" id="d292771e153" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d292771e151" rowspan="1" colspan="1">Ratings</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d292771e153" rowspan="1" colspan="1"><a href="jqe1558545669022.md#cps1507908555984">KNNRecommender Input</a> RatingTable.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d292771e151" rowspan="1" colspan="1">Weights</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d292771e153" rowspan="1" colspan="1"><a href="jqe1558545669022.md#ecq1507908560611">KNNRecommender Output</a> WeightModelTable.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d292771e151" rowspan="1" colspan="1">Bias</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d292771e153" rowspan="1" colspan="1"><a href="jqe1558545669022.md#ecq1507908560611">KNNRecommender Output</a> BiasModelTable.</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="slm1507907871462" xml:lang="en-us" lang="en-us" id="slm1507907871462">
<h2 class="title topictitle2" id="ariaid-title5">KNNRecommenderPredict Output</h2><div class="body refbody"><div class="section" id="slm1507907871462__section_eqg_mwk_ycb">
<h3 class="title sectiontitle">Output Table Schema</h3>
<p class="p">The table has <var class="keyword varname">top_k_recommendations</var> rows for each userid-itemid-prediction set.</p><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="slm1507907871462__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:20%" span="1"></col><col style="width:13.333333333333334%" span="1"></col><col style="width:66.66666666666666%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d292771e204" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d292771e206" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d292771e208" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d292771e204" rowspan="1" colspan="1">userid</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d292771e206" rowspan="1" colspan="1">INTEGER</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d292771e208" rowspan="1" colspan="1">Userid of user for whom items are recommended.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d292771e204" rowspan="1" colspan="1">itemid</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d292771e206" rowspan="1" colspan="1">INTEGER</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d292771e208" rowspan="1" colspan="1">Itemid of item recommended for user.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d292771e204" rowspan="1" colspan="1">prediction</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d292771e206" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d292771e208" rowspan="1" colspan="1">Predicted rating of item for user.</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="fwy1510706951489" xml:lang="en-us" lang="en-us" id="fwy1510706951489">
<h2 class="title topictitle2" id="ariaid-title6">KNNRecommenderPredict Example</h2><div class="body refbody"><div class="section" id="fwy1510706951489__section_jyf_2cr_tdb">
<h3 class="title sectiontitle">Input</h3><div class="p">From the <a href="jqe1558545669022.md#hez1510706776796">KNNRecommender Example</a>:
<ul class="ul" id="fwy1510706951489__ul_cc2_vcr_tdb">
<li class="li">Ratings: ml_ratings</li>
<li class="li">Weights: ml_weights</li>
<li class="li">Bias: ml_bias</li></ul></div></div><div class="section" id="fwy1510706951489__section_zhp_2cr_tdb">
<h3 class="title sectiontitle">SQL Call</h3>
<p class="p">The call recommends five movies for ten users.</p><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM KnnRecommenderPredict (
  ON (SELECT * FROM ml_ratings WHERE <span>userid <= 10</span>) AS Ratings
    PARTITION BY userid
  ON ml_bias AS Bias DIMENSION
  ON ml_weights AS Weights DIMENSION
  USING
  <span>TopK (5)</span>
) AS dt ORDER BY 1 DESC;</code></pre></div><div class="section" id="fwy1510706951489__section_dpd_fcr_tdb">
<h3 class="title sectiontitle">Output</h3><pre class="pre screen" xml:space="preserve"> userid itemid prediction         
 ------ ------ ------------------ 
      5    454   4.43944806005997
      5   2890  4.353130720557537
      5     34   4.43944806005997
      5    420 4.5586737193706535
      5    357 4.5150229309770635
      4   2023  4.472692557514834
      4   1258  4.472692557514834
      4    300  4.622911229674568
      4   1704  4.472692557514834
      4   2571  4.722330311219902
      3   1258  4.396245483590272
      3   1704  4.396245483590272
      3   2023  4.396245483590272
      3   2571  4.645740472524265
      3   1136  4.146753684279514
      3   1711  4.146753684279514
      3   1267  4.146753684279514
      2    515  4.540419986677616
      2    480  4.540419986677616
      2    296  4.463307355858737
      2    265  4.540419986677616
      2    648  4.540419986677616
      1   1278  4.228140795465176
      1    553  3.973010311922945
      1     21   4.02887733802919
      1    420  4.466978626573491
      1   1639  4.479795437756031</pre>
<p class="p">Some predicted ratings are higher than 5, even though the maximum rating is 5. The weighted KNN recommendation algorithm does not limit its results to the range of the input data. The outcome of interest are the items with the highest recommendation score; if the resulting ratings must be limited to a specific range, normalize the output data.</p>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div></div></body></html>
