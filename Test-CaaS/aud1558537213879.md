<html><head></head><body><div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="kbf1507569393238" id="kbf1507569393238"><h1 class="title topictitle1" id="ariaid-title1">TFIDF (ML Engine)</h1><div class="body conbody">
<p class="p">TF-IDF stands for "term frequency-inverse document frequency," a technique for evaluating the importance of a specific term in a specific document in a document set. Term frequency (<var class="keyword varname">tf</var>) is the number of times that the term appears in the document and inverse document frequency (<var class="keyword varname">idf</var>) is the number of times that the term appears in the document set. The TF-IDF score for a term is <var class="keyword varname">tf</var> *<var class="keyword varname">idf</var>. A term with a high TF-IDF score is especially relevant to the specific document.</p>
<p class="p">The TFIDF function can do either of the following:</p>
<ul class="ul" id="kbf1507569393238__ul_cts_gmv_q1b">
<li class="li">Take any document set and output the inverse document frequency (IDF)
				and term frequency- inverse document frequency (TF-IDF) scores for each term.</li>
<li class="li">Use the output of a previous run of the TFIDF function on a training document set to predict TFIDF scores of an input (test) document set.</li></ul><div class="p">You can use the TF-IDF scores as input for many document clustering and
			classification algorithms, including:
<ul class="ul" id="kbf1507569393238__ul_znx_xxp_yx">
<li class="li">Cosine-similarity</li>
<li class="li">Latent Dirichlet allocation</li>
<li class="li">K-means clustering</li>
<li class="li">K-nearest neighbors</li></ul></div>
<p class="p">You can use the TF-IDF scores derived from a training document set to create a model in a classification function (for example, <a href="kjz1558533259127.md#swn1507915086903">SVMSparse</a>) and then use the resulting TF-IDF scores in a classification prediction function (for example, <a href="wzb1541537305621.md#guu1507914686828">SVMSparsePredict_MLE</a>).</p>
<p class="p">The TFIDF function represents each document as an <var class="keyword varname">N</var>-dimensional vector, where <var class="keyword varname">N</var> is the number of terms in the document set (therefore, the document vector is usually very sparse). Each entry in the document vector is the TF-IDF score of a term.</p></div><div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="fmu1507569524200" xml:lang="en-us" lang="en-us" id="fmu1507569524200">
<h2 class="title topictitle2" id="ariaid-title2">TFIDF Syntax</h2><div class="body refbody"><div class="section" id="fmu1507569524200__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">TFIDF version 2.3, TF version 1.2</h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM TFIDF (
  ON TF (
    <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> PARTITION BY <var class="keyword varname">docid</var>     
    [ USING Formula ({ 'normal' | 'bool' | 'log' | 'augment' }) ]
  ) AS TF PARTITION BY <var class="keyword varname">term</var> 
  [ ON (SELECT COUNT (DISTINCT <var class="keyword varname">docid</var>) FROM <var class="keyword varname">doccount_table</var>) AS DocCount DIMENSION ]
  [ ON (SELECT <var class="keyword varname">term</var>, COUNT (DISTINCT <var class="keyword varname">docid</var>) FROM <var class="keyword varname">docperterm_table</var> GROUP BY <var class="keyword varname">term</var>)
      AS DocPerTerm PARTITION BY <var class="keyword varname">term</var>
  ]
  [ ON (SELECT DISTINCT (<var class="keyword varname">term</var>) AS term, idf FROM <var class="keyword varname">tf_idf_output_table</var>)
      AS IDF PARTITION BY <var class="keyword varname">term</var>
  ]
) AS <var class="keyword varname">alias</var>;</code></pre></div><div class="section" id="fmu1507569524200__section_sql_hcz_wy">
<h3 class="title sectiontitle">Large Document Sets</h3>
<p class="p">For large documents sets, the DocPerTerm table is required.</p>
<p class="p">For training, this is the syntax for large document sets:</p><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM TFIDF (
  ON TF (
    <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> PARTITION BY <var class="keyword varname">docid</var>      
    [ USING Formula ({ 'normal' | 'bool' | 'log' | 'augment' }) ]
  ) AS TF PARTITION BY <var class="keyword varname">term</var> 
  ON (SELECT COUNT (DISTINCT <var class="keyword varname">docid</var>) FROM <var class="keyword varname">doccount_table</var>) AS DocCount DIMENSION
  ON (SELECT <var class="keyword varname">term</var>, COUNT (DISTINCT <var class="keyword varname">docid</var>) FROM <var class="keyword varname">docperterm_table</var> GROUP BY <var class="keyword varname">term</var>)
    AS DocPerTerm PARTITION BY <var class="keyword varname">term</var> 
) AS <var class="keyword varname">alias</var> ORDER BY <var class="keyword varname">docid</var>;</code></pre>
<p class="p">For prediction, this is the syntax for large document sets:</p><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM TFIDF (
  ON TF (
    <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> PARTITION BY <var class="keyword varname">docid</var>      
    [ USING Formula ({ 'normal' | 'bool' | 'log' | 'augment' }) ]
  ) AS TF PARTITION BY <var class="keyword varname">term</var> 
  [ ON (SELECT <var class="keyword varname">term</var>, COUNT (DISTINCT <var class="keyword varname">docid</var>) FROM <var class="keyword varname">docperterm_table</var> GROUP BY <var class="keyword varname">term</var>)
      AS DocPerTerm PARTITION BY <var class="keyword varname">term</var>
  ]
  [ ON (SELECT DISTINCT (<var class="keyword varname">term</var>) AS <var class="keyword varname">term</var>, idf FROM <var class="keyword varname">tf_idf_output_table</var>)
      AS IDF PARTITION BY <var class="keyword varname">term</var>
  ]
) AS <var class="keyword varname">alias</var> ORDER BY <var class="keyword varname">docid</var>;</code></pre></div><div class="section" id="fmu1507569524200__section_upw_gcz_wy">
<h3 class="title sectiontitle">Small Document Sets</h3>
<p class="p">This syntax is acceptable for small document sets:</p><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM TFIDF (
  ON TF (
    <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> PARTITION BY <var class="keyword varname">docid</var> 
  ) AS TF PARTITION BY <var class="keyword varname">term</var> 
  ON (SELECT COUNT (DISTINCT <var class="keyword varname">docid</var>) FROM <var class="keyword varname">input_table</var>) AS DocCount DIMENSION
) AS <var class="keyword varname">alias</var> ORDER BY <var class="keyword varname">docid</var>;</code></pre></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="yup1507569536124" xml:lang="en-us" lang="en-us" id="yup1507569536124">
<h2 class="title topictitle2" id="ariaid-title3">TFIDF Syntax Elements</h2><div class="body refbody"><div class="section" id="yup1507569536124__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">Formula</dt><dd class="dd pd">[Optional] Specify the formula for calculating the term frequency (tf) of term <var class="keyword varname">t</var> in document <var class="keyword varname">d</var>:
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="yup1507569536124__table_rns_4lz_fdb" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:25%" span="1"></col><col style="width:75%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d172023e364" rowspan="1" colspan="1">Option</th><th class="entry cellrowborder" style="vertical-align:top;" id="d172023e366" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e364" rowspan="1" colspan="1"><code class="ph codeph">'normal'</code> (Default)</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e366" rowspan="1" colspan="1">Normalized frequency:
<p class="p"><code class="ph codeph">tf(<var class="keyword varname">t</var>,<var class="keyword varname">d</var>) = f ((<var class="keyword varname">t</var>,<var class="keyword varname">d</var>) / sum {<var class="keyword varname">w</var>,<var class="keyword varname">w</var> ∈<var class="keyword varname">d</var>}</code></p>
<p class="p">This value is <var class="keyword varname">rf</var> divided by number of terms in document.</p></td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e364" rowspan="1" colspan="1"><code class="ph codeph">'bool'</code></td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e366" rowspan="1" colspan="1">Boolean frequency:
<p class="p"><code class="ph codeph">tf((<var class="keyword varname">t</var>,<var class="keyword varname">d</var>) = 1</code> if <var class="keyword varname">t</var> occurs in <var class="keyword varname">d</var>; otherwise, <code class="ph codeph">tf((<var class="keyword varname">t</var>,<var class="keyword varname">d</var>) = 0</code>.</p></td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e364" rowspan="1" colspan="1"><code class="ph codeph">'log'</code></td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e366" rowspan="1" colspan="1">Logarithmically-scaled frequency:
<p class="p"><code class="ph codeph">tf((<var class="keyword varname">t</var>,<var class="keyword varname">d</var>) = log(f((<var class="keyword varname">t</var>,<var class="keyword varname">d</var>)+1)</code></p>
<p class="p">where <code class="ph codeph">f((<var class="keyword varname">t</var>,<var class="keyword varname">d</var>)</code> is the number of times <var class="keyword varname">t</var> occurs in <var class="keyword varname">d</var> (that is, raw frequency, <var class="keyword varname">rf</var>).</p></td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e364" rowspan="1" colspan="1"><code class="ph codeph">'augment'</code></td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e366" rowspan="1" colspan="1">Augmented frequency, which prevents bias towards longer documents:
<p class="p"><code class="ph codeph">tf((<var class="keyword varname">t</var>,<var class="keyword varname">d</var>) = 0.5 + (0.5 × f ((<var class="keyword varname">t</var>,<var class="keyword varname">d</var>) / max {f(<var class="keyword varname">w</var>,<var class="keyword varname">d</var>) : <var class="keyword varname">w</var> ∈<var class="keyword varname">d</var> })</code></p>
<p class="p">This value is <var class="keyword varname">rf</var> divided by maximum raw frequency of any term in document.</p></td></tr></tbody></table></div>
<p class="p">When using the output of a previous run of the TFIDF function on a training document set to predict TFIDF scores on an input document set, use the same Formula value for the input document set that you used for the training document set.</p></dd></dl></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="ank1507569551301" xml:lang="en-us" lang="en-us" id="ank1507569551301">
<h2 class="title topictitle2" id="ariaid-title4">TFIDF Input</h2><div class="body refbody"><div class="section" id="ank1507569551301__section_ncm_4gd_ycb">
<p class="p">The TFIDF function always requires as input the output of the TF function. Whether the other TFIDF input tables are required or optional depend on your reason for running the function.</p></div><div class="section" id="ank1507569551301__section_N1000E_N1000C_N10001"><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ank1507569551301__table_twq_t2d_ycb" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d172023e541" rowspan="1" colspan="1">Table</th><th class="entry cellrowborder" style="vertical-align:top;" id="d172023e543" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e541" rowspan="1" colspan="1">TF</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e543" rowspan="1" colspan="1">TF function input; document set.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e541" rowspan="1" colspan="1">DocCount</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e543" rowspan="1" colspan="1">Required if running function to output IDF and TF-IDF values for each term in document set.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e541" rowspan="1" colspan="1">DocPerTerm</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e543" rowspan="1" colspan="1">Optional if running function to output IDF and TF-IDF values for each term in document set.
<p class="p">If you omit this table, the function creates it by processing the entire document set, which can require a large amount of memory. If there is not enough memory to process the entire document set, the DocPerTerm table is required.</p></td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e541" rowspan="1" colspan="1">IDF</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e543" rowspan="1" colspan="1">Required if running function to predict TF-IDF scores. 
<p class="p">This table is the output of an earlier call to TFIDF, using the training document set as input to the TF function, the DocCount table, and optionally, the DocPerTerm table.</p></td></tr></tbody></table></div></div><div class="section" id="ank1507569551301__section_wtq_32d_ycb">
<h3 class="title sectiontitle">TF Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ank1507569551301__table_N10023_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:18.51851851851852%" span="1"></col><col style="width:14.814814814814813%" span="1"></col><col style="width:66.66666666666666%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d172023e580" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d172023e582" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d172023e584" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e580" rowspan="1" colspan="1"><var class="keyword varname">docid</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e582" rowspan="1" colspan="1">Any</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d172023e584" rowspan="1" colspan="1">Document identifier.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e580" rowspan="1" colspan="1"><var class="keyword varname">term</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e582" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d172023e584" rowspan="1" colspan="1">Term.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d172023e580" rowspan="1" colspan="1">count</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d172023e582" rowspan="1" colspan="1">INTEGER</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e584" rowspan="1" colspan="1">Number of times that term appears in document.</td></tr></tbody></table></div></div><div class="section" id="ank1507569551301__section_twj_j2d_ycb">
<h3 class="title sectiontitle">TF Output and TFIDF Input Table Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ank1507569551301__table_N10078_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:18.51851851851852%" span="1"></col><col style="width:14.814814814814813%" span="1"></col><col style="width:66.66666666666666%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d172023e620" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d172023e622" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d172023e624" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e620" rowspan="1" colspan="1"><var class="keyword varname">docid</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e622" rowspan="1" colspan="1">Any</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d172023e624" rowspan="1" colspan="1">Document identifier.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e620" rowspan="1" colspan="1"><var class="keyword varname">term</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e622" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d172023e624" rowspan="1" colspan="1">Term.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e620" rowspan="1" colspan="1">tf</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e622" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d172023e624" rowspan="1" colspan="1">Term frequency.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d172023e620" rowspan="1" colspan="1">count</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d172023e622" rowspan="1" colspan="1">INTEGER</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e624" rowspan="1" colspan="1">Number of times that term appears in document.</td></tr></tbody></table></div></div><div class="section" id="ank1507569551301__section_xrz_j2d_ycb">
<h3 class="title sectiontitle">DocCount Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ank1507569551301__table_N100DB_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:18.51851851851852%" span="1"></col><col style="width:14.814814814814813%" span="1"></col><col style="width:66.66666666666666%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d172023e667" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d172023e669" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d172023e671" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d172023e667" rowspan="1" colspan="1">count</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d172023e669" rowspan="1" colspan="1">BIGINT</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e671" rowspan="1" colspan="1">Number of documents in document set.</td></tr></tbody></table></div></div><div class="section" id="ank1507569551301__section_dh4_k2d_ycb">
<h3 class="title sectiontitle">DocPerTerm Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ank1507569551301__table_N10110_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:18.51851851851852%" span="1"></col><col style="width:14.814814814814813%" span="1"></col><col style="width:66.66666666666666%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d172023e691" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d172023e693" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d172023e695" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e691" rowspan="1" colspan="1"><var class="keyword varname">term</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e693" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d172023e695" rowspan="1" colspan="1">Term.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d172023e691" rowspan="1" colspan="1">count</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d172023e693" rowspan="1" colspan="1">BIGINT</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e695" rowspan="1" colspan="1">Number of documents that contain term.</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="ldv1507569576746" xml:lang="en-us" lang="en-us" id="ldv1507569576746">
<h2 class="title topictitle2" id="ariaid-title5">TFIDF Output</h2><div class="body refbody"><div class="section" id="ldv1507569576746__section_egw_hhd_ycb">
<h3 class="title sectiontitle">Output Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="ldv1507569576746__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:18.51851851851852%" span="1"></col><col style="width:14.814814814814813%" span="1"></col><col style="width:66.66666666666666%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d172023e732" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d172023e734" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d172023e736" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e732" rowspan="1" colspan="1"><var class="keyword varname">docid</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e734" rowspan="1" colspan="1">Any</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d172023e736" rowspan="1" colspan="1">Document identifier of document <var class="keyword varname">d</var>.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e732" rowspan="1" colspan="1"><var class="keyword varname">term</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e734" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d172023e736" rowspan="1" colspan="1">Term <var class="keyword varname">t</var>.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e732" rowspan="1" colspan="1">tf</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e734" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d172023e736" rowspan="1" colspan="1">Term frequency of term <var class="keyword varname">t</var> in document <var class="keyword varname">d</var>, calculated as specified by Formula syntax element.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e732" rowspan="1" colspan="1">idf</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d172023e734" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d172023e736" rowspan="1" colspan="1">Inverse document frequency of term <var class="keyword varname">t</var> in document <var class="keyword varname">d</var>, calculated by this formula:
<p class="p">IDF(<var class="keyword varname">t</var>) = log (<var class="keyword varname">doccount</var> / <var class="keyword varname">doccount</var> (<var class="keyword varname">t</var>))</p>
<p class="p">where <var class="keyword varname">doccount</var> is the number of documents in the document set and <var class="keyword varname">doccount</var> (<var class="keyword varname">t</var>) is the number of documents that contain the term <var class="keyword varname">t</var>.</p></td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d172023e732" rowspan="1" colspan="1">tf_idf</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d172023e734" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e736" rowspan="1" colspan="1">TFIDF score of term <var class="keyword varname">t</var> in document <var class="keyword varname">d</var>, calculated by this formula:
<p class="p">TFIDF(<var class="keyword varname">t</var>, <var class="keyword varname">d</var>) = TF(<var class="keyword varname">t</var>, <var class="keyword varname">d</var>) * IDF(<var class="keyword varname">t</var>)</p></td></tr></tbody></table></div></div></div></div><div class="topic concept nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="sjx1510350430155" xml:lang="en-us" lang="en-us" id="sjx1510350430155">
<h2 class="title topictitle2" id="ariaid-title6">TFIDF Examples</h2><div class="topic reference nested2" aria-labelledby="ariaid-title7" topicindex="7" topicid="myy1507570146812" xml:lang="en-us" lang="en-us" id="myy1507570146812">
<h3 class="title topictitle3" id="ariaid-title7">TFIDF Example: Tokenized Training Document Set</h3><div class="body refbody"><div class="section" id="myy1507570146812__section_N10011_N1000E_N10001">
<p class="p">This example uses the NGramSplitter_MLE function to tokenize a training document set, from which it creates the input table for the TFIDF function.</p></div><div class="section" id="myy1507570146812__section_mlj_nnm_n2b">
<h4 class="title sectiontitle">NGramSplitter_MLE Input: tfidf_train</h4><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="myy1507570146812__table_qps_ypm_n2b" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d172023e885" rowspan="1" colspan="1">docid</th><th class="entry cellrowborder" style="vertical-align:top;" id="d172023e887" rowspan="1" colspan="1">content</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e885" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e887" rowspan="1" colspan="1">Chennai floods have battered the capital city of Tamil Nadu and its adjoining areas. Normal life came to a standstill when roads were submerged in water and all modes of transport were severely affected. In the past, Chennai has had tsunamis and earthquakes</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e885" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e887" rowspan="1" colspan="1">Roger Federer born on 8 August 1981, is a greatest tennis player, who has been continuously ranked inside the top 10 since October 2002 and has won Wimbledon, USOpen, Australian and FrenchOpen titles mutiple times</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e885" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e887" rowspan="1" colspan="1">The Federer Nadal rivalry, known by many as Fedal, is between two professional tennis players, Roger Federer of Switzerland and Rafael Nadal of Spain. They are currently engaged in a storied rivalry, which many consider to be the greatest in tennis history. They have played 34 times, most recently in the 2015 Swiss Indoors final, and Nadal leads their eleven-year-old rivalry with an overall record of 23–11</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e885" rowspan="1" colspan="1">4</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e887" rowspan="1" colspan="1">The India Pakistan cricket rivalry is one of the most intense sports rivalries in the world. An India-Pakistan cricket match has been estimated to attract up to one billion viewers, according to TV ratings firms and various other reports. The 2011 World Cup semifinal between the two teams attracted around 988 million television viewers</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e885" rowspan="1" colspan="1">5</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e887" rowspan="1" colspan="1">An Ashes series is traditionally of five Tests, hosted in turn by England and Australia at least once every four years. As of August 2015, England hold the ashes, having won three of the five Tests in the 2015 Ashes series. Overall, Australia has won 32 series, England 32 and five series have been drawn.</td></tr></tbody></table></div></div><div class="section" id="myy1507570146812__section_qpj_2qm_n2b">
<h4 class="title sectiontitle">NGramSplitter_MLE SQL Call</h4>
<p class="p">This call creates a table of tokenized input, tfidf_token1, from tfidf_train.</p><pre class="pre codeblock" xml:space="preserve"><code>CREATE MULTISET TABLE tfidf_token1 AS (
  SELECT * FROM NGramSplitter_MLE (
    ON tfidf_train
    USING
    TextColumn ('content')
    Delimiter (' ')
    Grams ('1')
    Overlapping ('false')
    ConvertToLowerCase ('true')
    Punctuation ('\[.,?\!\]')
    Reset ('\[.,?\!\]')
    OutputTotalGramCount ('false')
    Accumulate ('docid')
  ) AS dt
) WITH DATA;</code></pre></div><div class="section" id="myy1507570146812__section_rjw_rqm_n2b">
<h4 class="title sectiontitle">SQL Call to Create TFIDF Input Table tfidf_input1</h4>
<p class="p">The TFIDF input table must have the tokenized input in the column term.</p><pre class="pre codeblock" xml:space="preserve"><code>CREATE MULTISET TABLE tfidf_input1 AS (
  SELECT docid, ngram AS term, frequency AS "count"
  FROM tfidf_token1 AS dt
) WITH DATA;</code></pre>
<p class="p">This query returns the following table:</p><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM tfidf_input1 ORDER BY 1, 3, 2;</code></pre><pre class="pre screen" xml:space="preserve"> docid term            count 
 ----- --------------- ----- 
     1 a                   1
     1 adjoining           1
     1 affected            1
     1 all                 1
     1 areas               1
     1 battered            1
     1 came                1
     1 capital             1
     1 city                1
     1 earthquakes         1
     1 floods              1
     1 had                 1
     1 has                 1
     1 have                1
     1 its                 1
     1 life                1
     1 modes               1
     1 nadu                1
     1 normal              1
     1 past                1
     1 roads               1
     1 severely            1
     1 standstill          1
     1 submerged           1
     1 tamil               1
     1 to                  1
     1 transport           1
     1 tsunamis            1
     1 water               1
     1 when                1
     1 chennai             2
     1 in                  2
     1 of                  2
     1 the                 2
     1 were                2
     1 and                 3
     2 10                  1
     2 1981                1
     2 2002                1
     2 8                   1
     2 a                   1
     2 august              1
     2 australian          1
     2 been                1
     2 born                1
     2 continuously        1
     2 federer             1
     2 frenchopen          1
     2 greatest            1
     2 inside              1
     2 is                  1
     2 mutiple             1
     2 october             1
     2 on                  1
     2 player              1
     2 ranked              1
     2 roger               1
     2 since               1
     2 tennis              1
     2 the                 1
     2 times               1
     2 titles              1
     2 top                 1
     2 usopen              1
     2 who                 1
     2 wimbledon           1
     2 won                 1
     2 and                 2
     2 has                 2
     3 2015                1
     3 23â??11             1
     3 34                  1
     3 a                   1
     3 an                  1
     3 are                 1
     3 as                  1
     3 be                  1
     3 between             1
     3 by                  1
     3 consider            1
     3 currently           1
     3 eleven-year-old     1
     3 engaged             1
     3 fedal               1
     3 final               1
     3 greatest            1
     3 have                1
     3 history             1
     3 indoors             1
     3 is                  1
     3 known               1
     3 leads               1
     3 most                1
     3 overall             1
     3 played              1
     3 players             1
     3 professional        1
     3 rafael              1
     3 recently            1
     3 record              1
     3 roger               1
     3 spain               1
     3 storied             1
     3 swiss               1
     3 switzerland         1
     3 their               1
     3 times               1
     3 to                  1
     3 two                 1
     3 which               1
     3 with                1
     3 and                 2
     3 federer             2
     3 many                2
     3 tennis              2
     3 they                2
     3 in                  3
     3 nadal               3
     3 of                  3
     3 rivalry             3
     3 the                 3
     4 2011                1
     4 988                 1
     4 according           1
     4 an                  1
     4 and                 1
     4 around              1
     4 attract             1
     4 attracted           1
     4 been                1
     4 between             1
     4 billion             1
     4 cup                 1
     4 estimated           1
     4 firms               1
     4 has                 1
     4 in                  1
     4 india               1
     4 india-pakistan      1
     4 intense             1
     4 is                  1
     4 match               1
     4 million             1
     4 most                1
     4 of                  1
     4 other               1
     4 pakistan            1
     4 ratings             1
     4 reports             1
     4 rivalries           1
     4 rivalry             1
     4 semifinal           1
     4 sports              1
     4 teams               1
     4 television          1
     4 tv                  1
     4 two                 1
     4 up                  1
     4 various             1
     4 cricket             2
     4 one                 2
     4 viewers             2
     4 world               2
     4 to                  3
     4 the                 5
     5 an                  1
     5 as                  1
     5 at                  1
     5 august              1
     5 been                1
     5 by                  1
     5 drawn               1
     5 every               1
     5 four                1
     5 has                 1
     5 have                1
     5 having              1
     5 hold                1
     5 hosted              1
     5 is                  1
     5 least               1
     5 once                1
     5 overall             1
     5 three               1
     5 traditionally       1
     5 turn                1
     5 years               1
     5 2015                2
     5 32                  2
     5 and                 2
     5 australia           2
     5 in                  2
     5 tests               2
     5 won                 2
     5 ashes               3
     5 england             3
     5 five                3
     5 of                  3
     5 the                 3
     5 series              4</pre></div><div class="section" id="myy1507570146812__section_ysg_1tm_n2b">
<h4 class="title sectiontitle">SQL Call to Create TFIDF Input Table tf1</h4><pre class="pre codeblock" xml:space="preserve"><code>CREATE MULTISET TABLE tf1 AS (
  SELECT * FROM tf (
    ON tfidf_input1 PARTITION BY docid
  ) AS dt1
) WITH DATA;
</code></pre></div><div class="section" id="myy1507570146812__section_u4s_nnm_n2b">
<h4 class="title sectiontitle">TFIDF SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>CREATE MULTISET TABLE tfidf_output1 AS (
  SELECT * FROM TFIDF (
    ON <span>tf1</span> AS TF PARTITION BY term
    ON (
      SELECT CAST(COUNT(DISTINCT(docid)) AS integer) AS "count"
      FROM <span>tfidf_input1</span>
    ) AS DocCount DIMENSION
  ) AS dt
) WITH DATA;</code></pre></div><div class="section" id="myy1507570146812__section_qg2_4nm_n2b">
<h4 class="title sectiontitle">TFIDF Output</h4>
<p class="p">This query returns the following table:</p><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM tfidf_output1 ORDER BY tfidf DESC;</code></pre><pre class="pre screen" xml:space="preserve"> docid term            tf                   idf                 tf_idf                
 ----- --------------- -------------------- ------------------- --------------------- 
     5 series           0.07272727272727272  1.6094379124341003   0.11705002999520729
     5 ashes            0.05454545454545454  1.6094379124341003   0.08778752249640547
     5 england          0.05454545454545454  1.6094379124341003   0.08778752249640547
     5 five             0.05454545454545454  1.6094379124341003   0.08778752249640547
     1 chennai         0.046511627906976744  1.6094379124341003   0.07485757732251629
     1 were            0.046511627906976744  1.6094379124341003   0.07485757732251629
     3 nadal            0.04477611940298507  1.6094379124341003   0.07206438413884031
     4 one             0.037037037037037035  1.6094379124341003   0.05960881157163334
     4 cricket         0.037037037037037035  1.6094379124341003   0.05960881157163334
     4 viewers         0.037037037037037035  1.6094379124341003   0.05960881157163334
     4 world           0.037037037037037035  1.6094379124341003   0.05960881157163334
     5 tests            0.03636363636363636  1.6094379124341003  0.058525014997603646
     5 australia        0.03636363636363636  1.6094379124341003  0.058525014997603646
     5 32               0.03636363636363636  1.6094379124341003  0.058525014997603646
     3 many            0.029850746268656716  1.6094379124341003   0.04804292275922687
     3 they            0.029850746268656716  1.6094379124341003   0.04804292275922687
     2 mutiple          0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 10               0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 inside           0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 on               0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 player           0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 october          0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 frenchopen       0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 since            0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 titles           0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 2002             0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 continuously     0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 australian       0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 usopen           0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 wimbledon        0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 1981             0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 who              0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 ranked           0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 born             0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 8                0.02857142857142857  1.6094379124341003   0.04598394035526001
     2 top              0.02857142857142857  1.6094379124341003   0.04598394035526001
     3 rivalry          0.04477611940298507  0.9162907318741551   0.04102794321824575
     1 earthquakes     0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 submerged       0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 past            0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 transport       0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 capital         0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 city            0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 battered        0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 roads           0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 areas           0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 tamil           0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 standstill      0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 nadu            0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 life            0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 severely        0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 adjoining       0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 all             0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 had             0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 came            0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 modes           0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 its             0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 affected        0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 tsunamis        0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 when            0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 floods          0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 normal          0.023255813953488372  1.6094379124341003   0.03742878866125814
     1 water           0.023255813953488372  1.6094379124341003   0.03742878866125814
     5 2015             0.03636363636363636  0.9162907318741551     0.033319662977242
     5 won              0.03636363636363636  0.9162907318741551     0.033319662977242
     4 around          0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 teams           0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 india           0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 television      0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 tv              0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 estimated       0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 other           0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 india-pakistan  0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 various         0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 cup             0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 ratings         0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 988             0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 attracted       0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 up              0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 rivalries       0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 reports         0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 billion         0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 attract         0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 match           0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 million         0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 sports          0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 pakistan        0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 semifinal       0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 intense         0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 firms           0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 2011            0.018518518518518517  1.6094379124341003   0.02980440578581667
     4 according       0.018518518518518517  1.6094379124341003   0.02980440578581667
     5 having           0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 turn             0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 drawn            0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 four             0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 traditionally    0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 years            0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 hosted           0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 at               0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 hold             0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 every            0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 once             0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 least            0.01818181818181818  1.6094379124341003  0.029262507498801823
     5 three            0.01818181818181818  1.6094379124341003  0.029262507498801823
     4 to               0.05555555555555555  0.5108256237659907  0.028379201320332816
     3 tennis          0.029850746268656716  0.9162907318741551  0.027351962145497167
     3 federer         0.029850746268656716  0.9162907318741551  0.027351962145497167
     2 won              0.02857142857142857  0.9162907318741551   0.02617973519640443
     2 roger            0.02857142857142857  0.9162907318741551   0.02617973519640443
     2 federer          0.02857142857142857  0.9162907318741551   0.02617973519640443
     2 greatest         0.02857142857142857  0.9162907318741551   0.02617973519640443
     2 times            0.02857142857142857  0.9162907318741551   0.02617973519640443
     2 tennis           0.02857142857142857  0.9162907318741551   0.02617973519640443
     2 august           0.02857142857142857  0.9162907318741551   0.02617973519640443
     3 played          0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 spain           0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 swiss           0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 leads           0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 are             0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 with            0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 34              0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 recently        0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 history         0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 indoors         0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 storied         0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 23â??11         0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 engaged         0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 switzerland     0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 consider        0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 currently       0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 record          0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 which           0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 fedal           0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 their           0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 rafael          0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 be              0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 players         0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 known           0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 eleven-year-old 0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 final           0.014925373134328358  1.6094379124341003  0.024021461379613435
     3 professional    0.014925373134328358  1.6094379124341003  0.024021461379613435
     4 between         0.018518518518518517  0.9162907318741551  0.016968346886558426
     4 two             0.018518518518518517  0.9162907318741551  0.016968346886558426
     4 rivalry         0.018518518518518517  0.9162907318741551  0.016968346886558426
     4 most            0.018518518518518517  0.9162907318741551  0.016968346886558426
     5 overall          0.01818181818181818  0.9162907318741551     0.016659831488621
     5 by               0.01818181818181818  0.9162907318741551     0.016659831488621
     5 as               0.01818181818181818  0.9162907318741551     0.016659831488621
     5 august           0.01818181818181818  0.9162907318741551     0.016659831488621
     2 been             0.02857142857142857  0.5108256237659907  0.014595017821885449
     2 a                0.02857142857142857  0.5108256237659907  0.014595017821885449
     3 greatest        0.014925373134328358  0.9162907318741551  0.013675981072748583
     3 roger           0.014925373134328358  0.9162907318741551  0.013675981072748583
     3 as              0.014925373134328358  0.9162907318741551  0.013675981072748583
     3 overall         0.014925373134328358  0.9162907318741551  0.013675981072748583
     3 most            0.014925373134328358  0.9162907318741551  0.013675981072748583
     3 2015            0.014925373134328358  0.9162907318741551  0.013675981072748583
     3 times           0.014925373134328358  0.9162907318741551  0.013675981072748583
     3 between         0.014925373134328358  0.9162907318741551  0.013675981072748583
     3 two             0.014925373134328358  0.9162907318741551  0.013675981072748583
     3 by              0.014925373134328358  0.9162907318741551  0.013675981072748583
     2 has              0.05714285714285714 0.22314355131420976    0.0127510600750977
     5 of               0.05454545454545454 0.22314355131420976  0.012171466435320532
     1 a               0.023255813953488372  0.5108256237659907  0.011879665668976528
     1 have            0.023255813953488372  0.5108256237659907  0.011879665668976528
     1 to              0.023255813953488372  0.5108256237659907  0.011879665668976528
     1 in              0.046511627906976744 0.22314355131420976  0.010378769828567896
     1 of              0.046511627906976744 0.22314355131420976  0.010378769828567896
     3 in               0.04477611940298507 0.22314355131420976  0.009991502297651183
     3 of               0.04477611940298507 0.22314355131420976  0.009991502297651183
     4 been            0.018518518518518517  0.5108256237659907  0.009459733773444272
     4 an              0.018518518518518517  0.5108256237659907  0.009459733773444272
     5 been             0.01818181818181818  0.5108256237659907  0.009287738613927104
     5 have             0.01818181818181818  0.5108256237659907  0.009287738613927104
     5 an               0.01818181818181818  0.5108256237659907  0.009287738613927104
     5 in               0.03636363636363636 0.22314355131420976  0.008114310956880354
     3 have            0.014925373134328358  0.5108256237659907  0.007624263041283444
     3 to              0.014925373134328358  0.5108256237659907  0.007624263041283444
     3 an              0.014925373134328358  0.5108256237659907  0.007624263041283444
     3 a               0.014925373134328358  0.5108256237659907  0.007624263041283444
     2 is               0.02857142857142857 0.22314355131420976   0.00637553003754885
     1 has             0.023255813953488372 0.22314355131420976  0.005189384914283948
     4 in              0.018518518518518517 0.22314355131420976  0.004132287987300181
     4 has             0.018518518518518517 0.22314355131420976  0.004132287987300181
     4 is              0.018518518518518517 0.22314355131420976  0.004132287987300181
     4 of              0.018518518518518517 0.22314355131420976  0.004132287987300181
     5 has              0.01818181818181818 0.22314355131420976  0.004057155478440177
     5 is               0.01818181818181818 0.22314355131420976  0.004057155478440177
     3 is              0.014925373134328358 0.22314355131420976 0.0033305007658837277
     4 the              0.09259259259259259                 0.0                   0.0
     4 and             0.018518518518518517                 0.0                   0.0
     2 the              0.02857142857142857                 0.0                   0.0
     2 and              0.05714285714285714                 0.0                   0.0
     3 and             0.029850746268656716                 0.0                   0.0
     3 the              0.04477611940298507                 0.0                   0.0
     5 the              0.05454545454545454                 0.0                   0.0
     5 and              0.03636363636363636                 0.0                   0.0
     1 the             0.046511627906976744                 0.0                   0.0
     1 and              0.06976744186046512                 0.0                   0.0</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div><div class="topic reference nested2" aria-labelledby="ariaid-title8" topicindex="8" topicid="wcb1507573019641" xml:lang="en-us" lang="en-us" id="wcb1507573019641">
<h3 class="title topictitle3" id="ariaid-title8">TFIDF Example: Tokenized Test Set</h3><div class="body refbody"><div class="section" id="wcb1507573019641__section_N10011_N1000E_N10001">
<p class="p">This example uses the IDF values from tfidf_output1, output by <a href="aud1558537213879.md#myy1507570146812">TFIDF Example: Tokenized Training Document Set</a> to predict the TFIDF scores of a test document set.</p></div><div class="section" id="wcb1507573019641__section_c4g_j5m_n2b">
<h4 class="title sectiontitle">NGramSplitter_MLE Input: tfidf_test</h4><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="wcb1507573019641__table_u3q_l5m_n2b" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d172023e1004" rowspan="1" colspan="1">docid</th><th class="entry cellrowborder" style="vertical-align:top;" id="d172023e1006" rowspan="1" colspan="1">content</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e1004" rowspan="1" colspan="1">6</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e1006" rowspan="1" colspan="1">In Chennai, India, floods have closed roads and factories, turned off power, shut down the airport and forced thousands of people out of their homes.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e1004" rowspan="1" colspan="1">7</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e1006" rowspan="1" colspan="1">Spanish tennis star Rafael Nadal said he was happy with the improvement in his game after a below-par year, and looked forward to reigniting his long-time rivalry with Roger Federer in India.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e1004" rowspan="1" colspan="1">8</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d172023e1006" rowspan="1" colspan="1">Nadal, the world number five, said he has always enjoyed playing against Federer and hoped they would do so for years to come.</td></tr></tbody></table></div></div><div class="section" id="wcb1507573019641__section_rjd_45m_n2b">
<h4 class="title sectiontitle">NGramSplitter_MLE SQL Call</h4>
<p class="p">This call creates a table of tokenized input, tfidf_token1, from tfidf_test.</p><pre class="pre codeblock" xml:space="preserve"><code>CREATE MULTISET TABLE tfidf_token1 AS (
  SELECT * FROM NGramSplitter_MLE (
    ON tfidf_test
    USING
    TextColumn ('content')
    Delimiter (' ')
    Grams ('1')
    Overlapping ('false')
    ConvertToLowerCase ('true')
    Punctuation ('\[.,?\!\]')
    Reset ('\[.,?\!\]')
    OutputTotalGramCount ('false')
    Accumulate ('docid')
  ) AS dt
) WITH DATA;</code></pre></div><div class="section" id="wcb1507573019641__section_sp3_w5m_n2b">
<h4 class="title sectiontitle">SQL Call to Create TFIDF Input Table tfidf_input1</h4><pre class="pre codeblock" xml:space="preserve"><code>CREATE MULTISET TABLE tfidf_input1 AS (
  SELECT docid, ngram AS term, frequency AS "count" FROM tfidf_token1 AS dt
) WITH DATA;
</code></pre></div><div class="section" id="wcb1507573019641__section_psm_4xm_n2b">
<h4 class="title sectiontitle">SQL Call to Create TFIDF Input Table tf1</h4><pre class="pre codeblock" xml:space="preserve"><code>CREATE MULTISET TABLE tf1 AS (
  SELECT * FROM tf (
    ON tfidf_input1 PARTITION BY docid
    USING
    Formula ('normal')
  ) AS dt1
) WITH DATA;</code></pre></div><div class="section" id="wcb1507573019641__section_idg_1vm_n2b">
<h4 class="title sectiontitle">TFIDF SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>CREATE MULTISET TABLE tfidf_output2 AS (
  SELECT * FROM TFIDF (
    ON tf2 AS TF PARTITION BY TERM
	ON (SELECT CAST(COUNT(DISTINCT(docid)) AS INTEGER) AS "count"
      FROM tfidf_output1) AS DocCount DIMENSION
  ) AS dt
) WITH DATA;</code></pre></div><div class="section" id="wcb1507573019641__section_tgv_dvm_n2b">
<h4 class="title sectiontitle">TFIDF Output</h4>
<p class="p">This query returns the following table:</p><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM tfidf_output2 ORDER BY tf_idf DESC;</code></pre><pre class="pre screen" xml:space="preserve"> docid term        tf                   idf                tf_idf               
 ----- ----------- -------------------- ------------------ -------------------- 
     6 of                          0.08 1.6094379124341003    0.128755032994728
     7 his                       0.0625 1.6094379124341003  0.10058986952713127
     7 with                      0.0625 1.6094379124341003  0.10058986952713127
     8 so          0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 world       0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 always      0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 enjoyed     0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 they        0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 come        0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 has         0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 playing     0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 hoped       0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 years       0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 number      0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 against     0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 would       0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 five        0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 do          0.043478260869565216 1.6094379124341003  0.06997556141017827
     8 for         0.043478260869565216 1.6094379124341003  0.06997556141017827
     6 chennai                     0.04 1.6094379124341003    0.064377516497364
     6 down                        0.04 1.6094379124341003    0.064377516497364
     6 turned                      0.04 1.6094379124341003    0.064377516497364
     6 factories                   0.04 1.6094379124341003    0.064377516497364
     6 their                       0.04 1.6094379124341003    0.064377516497364
     6 people                      0.04 1.6094379124341003    0.064377516497364
     6 have                        0.04 1.6094379124341003    0.064377516497364
     6 off                         0.04 1.6094379124341003    0.064377516497364
     6 airport                     0.04 1.6094379124341003    0.064377516497364
     6 thousands                   0.04 1.6094379124341003    0.064377516497364
     6 forced                      0.04 1.6094379124341003    0.064377516497364
     6 out                         0.04 1.6094379124341003    0.064377516497364
     6 roads                       0.04 1.6094379124341003    0.064377516497364
     6 shut                        0.04 1.6094379124341003    0.064377516497364
     6 power                       0.04 1.6094379124341003    0.064377516497364
     6 closed                      0.04 1.6094379124341003    0.064377516497364
     6 floods                      0.04 1.6094379124341003    0.064377516497364
     6 homes                       0.04 1.6094379124341003    0.064377516497364
     7 in                        0.0625 0.9162907318741551 0.057268170742134694
     7 star                     0.03125 1.6094379124341003 0.050294934763565634
     7 after                    0.03125 1.6094379124341003 0.050294934763565634
     7 long-time                0.03125 1.6094379124341003 0.050294934763565634
     7 improvement              0.03125 1.6094379124341003 0.050294934763565634
     7 was                      0.03125 1.6094379124341003 0.050294934763565634
     7 looked                   0.03125 1.6094379124341003 0.050294934763565634
     7 reigniting               0.03125 1.6094379124341003 0.050294934763565634
     7 rafael                   0.03125 1.6094379124341003 0.050294934763565634
     7 spanish                  0.03125 1.6094379124341003 0.050294934763565634
     7 forward                  0.03125 1.6094379124341003 0.050294934763565634
     7 year                     0.03125 1.6094379124341003 0.050294934763565634
     7 rivalry                  0.03125 1.6094379124341003 0.050294934763565634
     7 happy                    0.03125 1.6094379124341003 0.050294934763565634
     7 tennis                   0.03125 1.6094379124341003 0.050294934763565634
     7 a                        0.03125 1.6094379124341003 0.050294934763565634
     7 below-par                0.03125 1.6094379124341003 0.050294934763565634
     7 game                     0.03125 1.6094379124341003 0.050294934763565634
     7 roger                    0.03125 1.6094379124341003 0.050294934763565634
     6 and                         0.08 0.5108256237659907  0.04086604990127926
     8 to          0.043478260869565216 0.9162907318741551 0.039838727472789354
     8 he          0.043478260869565216 0.9162907318741551 0.039838727472789354
     8 nadal       0.043478260869565216 0.9162907318741551 0.039838727472789354
     8 said        0.043478260869565216 0.9162907318741551 0.039838727472789354
     8 federer     0.043478260869565216 0.9162907318741551 0.039838727472789354
     6 india                       0.04 0.9162907318741551  0.03665162927496621
     6 in                          0.04 0.9162907318741551  0.03665162927496621
     7 nadal                    0.03125 0.9162907318741551 0.028634085371067347
     7 to                       0.03125 0.9162907318741551 0.028634085371067347
     7 india                    0.03125 0.9162907318741551 0.028634085371067347
     7 he                       0.03125 0.9162907318741551 0.028634085371067347
     7 federer                  0.03125 0.9162907318741551 0.028634085371067347
     7 said                     0.03125 0.9162907318741551 0.028634085371067347
     8 the         0.043478260869565216 0.5108256237659907 0.022209809728956118
     8 and         0.043478260869565216 0.5108256237659907 0.022209809728956118
     6 the                         0.04 0.5108256237659907  0.02043302495063963
     7 and                      0.03125 0.5108256237659907  0.01596330074268721
     7 the                      0.03125 0.5108256237659907  0.01596330074268721</pre>
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div></div></div></body></html>
