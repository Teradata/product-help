AWS認証
-------

AWS Identity and Access Management (IAM) ロールを使用して、VantageCloud LakeからAWS S3バケット内のデータへのフロー アクセス権を付与できます。各データ ソースは、S3バケット内の特定のパスに対応しています。

**注:** 再利用するフロー用のIAMロールとポリシーをすでに作成している場合は、このステップを省略できます。

始める前に、AWSコンソールを開いた状態で2つ目のブラウザ ウィンドウを開いておいてください。VantageCloudコンソールとAWSコンソールの間で情報のコピーを行う際に必要となります。

**AWSのロール権限ポリシーと信頼ポリシーを生成する**を選択します。

**権限ポリシーと信頼ポリシー** ウィンドウで、AWSコンソールで見つけた次の情報を入力します。

-   **AWSロールARN**:ロールを識別するAmazonリソース ネームです。

-   **AWS外部ID**:与えられたAWSロールを引き受けるときにVantageCloud Lakeが使用する一意の識別子です。

-   **S3バケット パスURI**:ソース バケットへのパスです。URIスキームは必ず `s3://` としてください。このパスには読み取り権限が必要です

-   **S3マニフェスト バケット パッチURI**:Vantageがマニフェスト ファイルを書き込むバケットへのパスで、ソース バケット内のオブジェクト (ファイル) を一覧表示します。外部テーブルは、マニフェスト ファイルを使用して、読み込むファイルを選択します。URIスキームは必ず `s3://` としてください。このパスには次の権限が必要です。

    -   ListBucket

    -   PutObject

    -   GetObject

    -   DeleteObject

    -   GetBucketLocation

    **注:** マニフェスト バケットとソース バケットは、同一のバケットにすることも可能です。バケット内では、マニフェスト ファイルが1つのフォルダ (マニフェスト プレフィックスにより識別) にあり、ソース ファイルが別のフォルダ (ソース プレフィックスにより識別) にある必要があります。どちらのフォルダも、他方のサブディレクトリに置くことはできません。

    [AWS Identity and Access Managementユーザー ガイド](https://docs.aws.amazon.com/IAM/latest/UserGuide) および [フローにAWS S3リソースへのアクセスを付与](https://docs.teradata.com/access/sources/dita/topic?dita:mapPath=phg1621910019905.ditamap&dita:ditavalPath=pny1626732985837.ditaval&dita:topicPath=opp1680103532746.dita) を参照してください。

情報を入力したら、**ポリシーを生成する** を選択して必要なJSONを作成します。

生成された **権限ポリシー** と **信頼ポリシー** をAWSのロール権限ポリシーと信頼ポリシーにコピーします。

AWS Management Consoleでは、1つまたは複数のバケットに権限を付与する1つまたは複数のIAMポリシーを、IAMロールに関連付けることができます。これにより、ロールを引き受けるフロー サービスにバケットへの権限が与えられます。ロールに関連付けられたポリシーは、すべてのフローの [ソース](npn1691594431074.md) へのアクセスを提供する必要があります。

Azure認証
---------

以下の認証タイプがサポートされており、Azureストレージ アカウントで確認できます (1つのみ必要)。

-   **共有アクセス署名 (SAS) トークン** はNOS認証オブジェクトで、ソース ファイルとマニフェスト ファイルのコンテナーへのアクセスに使用されます。

-   **ストレージ アカウントのアクセス キーと接続文字列** は、ストレージ アカウントへのフロー サービス リクエストを認証します。

フロー内の各ソース/ターゲット構成には2つの個別のストレージ ロケーションが必要で、1つはソース データ用、もう1つはフロー マニフェスト用です。これらのロケーションは、個別で、非入れ子型で、同じストレージ アカウント内に存在する必要があります。必要な構成は、ストレージ アカウントで階層名前空間を使用するかどうかによって異なります。

**階層名前空間を使用する場合:**

-   ソース データとフロー マニフェストの両方に単一のストレージ コンテナーを使用することが可能です。ただし、それらが互いにサブディレクトリとして格納されていない場合に限ります。

-   認証には、ストレージ アカウント アクセス キーまたはSASトークン (ストレージ アカウントまたはコンテナー レベル) のいずれかを使用できます。

**階層名前空間を使用しない場合:**

-   ソース データとフロー マニフェストは、個別のストレージ コンテナーに配置する必要があります。

-   認証は、ストレージ アカウント アクセス キーまたはストレージ アカウント固有のSASトークンの使用に制限されます。

詳細については、[VantageCloud Lake (Azure) を使用したフローの作成](https://docs.teradata.com/access/sources/dita/topic?dita:topicPath=fhd1708636431287) を参照してください。
