<html><head></head><body><div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="vcy1507767993321" id="vcy1507767993321"><h1 class="title topictitle1" id="ariaid-title1">NTree (ML Engine)</h1><div class="body conbody">
<p class="p">The NTree function is a hierarchical analysis <span><b>SQL</b></span> function that can build and traverse tree structures on all worker machines. The function reads the data only once from the disk and creates the trees in memory.</p>
<p class="p">The input data must be partitionable, and each partition must fit in
			memory. Each partition can consist of multiple trees of any size. The function provides
			different ways of handling cycles.</p></div><div class="related-links"><div class="linklistheader"><p></p><b>Related Information</b></div>
<ul class="linklist linklist relinfo"><div class="linklistmember"><a href="ngy1558544263564.md#bhu1507815860164">GTree (ML Engine)</a></div></ul></div><div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="chc1507768926190" xml:lang="en-us" lang="en-us" id="chc1507768926190">
<h2 class="title topictitle2" id="ariaid-title2">NTree Syntax</h2><div class="body refbody"><div class="section" id="chc1507768926190__section_N1000E_N1000C_N10001">
<h3 class="title sectiontitle">Version <span>1.4</span></h3><div class="note note" id="chc1507768926190__note_N10019_N10011_N1000E_N10001"><span><b>Note</b></span><div class="notebody">This function requires "@coprocessor".</div></div><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM NTree@coprocessor (
  <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span>
    PARTITION BY { 1 | <var class="keyword varname">partition_column</var> [,...] }
    [ ORDER BY <var class="keyword varname">ordering_column</var> [,...] ]
  USING
  RootNode (<var class="keyword varname">root_node_expression</var>)
  NodeID (<var class="keyword varname">node_id_expression</var>)
  ParentID (<var class="keyword varname">parent_id_expression</var>)
  [ AllowCycles (<span><b>{'true'|'t'|'yes'|'y'|'1'|'false'|'f'|'no'|'n'|'0'}</b></span>) ]
  StartsWith ({ 'root' | 'leaf' | <var class="keyword varname">starting_node_id_expression</var> })
  Direction ({ 'up' | 'down' })
  OutputType ({ 'end' | 'all' })
  [ MaxDistance (<var class="keyword varname">max_distance</var>) ]
  [ OutputLogMessages (<span><b>{'true'|'t'|'yes'|'y'|'1'|'false'|'f'|'no'|'n'|'0'}</b></span>)]
  Results (<var class="keyword varname">aggregate</var> [,...])
) AS <var class="keyword varname">alias</var>;</code></pre></div></div><div class="related-links"><div class="linklistheader"><p></p><b>Related Information</b></div>
<ul class="linklist linklist relinfo"><div class="linklistmember"><a href="eta1543514041091.md">Comments in Queries</a></div></ul></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="wfw1507769030861" xml:lang="en-us" lang="en-us" id="wfw1507769030861">
<h2 class="title topictitle2" id="ariaid-title3">NTree Syntax Elements</h2><div class="body refbody"><div class="section" id="wfw1507769030861__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">RootNode</dt><dd class="dd pd">Specify the BOOLEAN SQL expression that defines the root nodes of the trees (for example, <var class="keyword varname">parent_id</var> IS NULL).</dd><dt class="dt pt dlterm">NodeID</dt><dd class="dd pd">Specify the SQL expression whose value uniquely identifies a node in the input table (for example, <var class="keyword varname">order_id</var>).</dd><dd class="dd pd ddexpand">A node can appear multiple times in the data set, with different parents.</dd><dt class="dt pt dlterm">ParentID</dt><dd class="dd pd">Specify the SQL expression whose value identifies the parent node.</dd><dt class="dt pt dlterm">AllowCycles</dt><dd class="dd pd">[Optional] Specify whether trees can contain cycles. If not, a cycle in the data set causes the function to throw an exception. For information about cycles, see <a href="ypx1542214533649.md">Cycles in NTree</a>.</dd><dd class="dd pd ddexpand">Default: 'false'</dd><dt class="dt pt dlterm">StartsWith</dt><dd class="dd pd">Specify the node from which to start tree traversal—'root', 'leaf', or a SQL expression that identifies a node.</dd><dt class="dt pt dlterm">Direction</dt><dd class="dd pd">Specify the direction of tree traversal from the start node—up to the root node or down to the leaf nodes.</dd><dt class="dt pt dlterm">OutputType</dt><dd class="dd pd">Specify when to output a tuple—at every node along the traversal path ('all') or only at the end of the traversal path ('end').</dd><dt class="dt pt dlterm">MaxDistance</dt><dd class="dd pd">[Optional] Specify the maximum tree depth.</dd><dd class="dd pd ddexpand">Default: 5</dd><dt class="dt pt dlterm">OutputLogMessages</dt><dd class="dd pd">[Optional] Specify whether the function prints log messages.</dd><dd class="dd pd ddexpand">Default: 'false'</dd><dt class="dt pt dlterm">Results</dt><dd class="dd pd">Specify aggregate operations to perform during tree traversal, using this syntax:<pre class="pre codeblock" xml:space="preserve"><code><var class="keyword varname">operation</var> (<var class="keyword varname">expression</var>) [ ALIAS <var class="keyword varname">alias</var> ]</code></pre><dl class="dl parml"><dt class="dt pt dlterm"><var class="keyword varname">operation</var></dt><dd class="dd pd">One of the following:
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="wfw1507769030861__table_c2v_ztz_fdb" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:25%" span="1"></col><col style="width:75%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d71060e242" rowspan="1" colspan="1"><var class="keyword varname">operation</var></th><th class="entry cellrowborder" style="vertical-align:top;" id="d71060e245" rowspan="1" colspan="1"><var class="keyword varname">operation</var> Action for Path from StartsWith Node to Last Traversed Node</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e242" rowspan="1" colspan="1">PATH</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e245" rowspan="1" colspan="1">Outputs value of <var class="keyword varname">expression</var> for each node, separating values with '->'.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e242" rowspan="1" colspan="1">SUM</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e245" rowspan="1" colspan="1">Computes value of <var class="keyword varname">expression</var> for each node and outputs sum of these values.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e242" rowspan="1" colspan="1">LEVEL</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e245" rowspan="1" colspan="1">Outputs number of hops.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e242" rowspan="1" colspan="1">MAX</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e245" rowspan="1" colspan="1">Computes value of <var class="keyword varname">expression</var> for each node and outputs highest of these values.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e242" rowspan="1" colspan="1">MIN</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e245" rowspan="1" colspan="1">Computes value of <var class="keyword varname">expression</var> for each node and outputs lowest of these values.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e242" rowspan="1" colspan="1">IS_CYCLE</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e245" rowspan="1" colspan="1">Outputs cycle (if any).</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e242" rowspan="1" colspan="1">AVG</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e245" rowspan="1" colspan="1">Computes value of <var class="keyword varname">expression</var> for each node and outputs average of these values.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e242" rowspan="1" colspan="1">PROPAGATE</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d71060e245" rowspan="1" colspan="1">Evaluates <var class="keyword varname">expression</var> with value of StartsWith node and propagates result to every node.</td></tr></tbody></table></div></dd><dt class="dt pt dlterm"><var class="keyword varname">expression</var></dt><dd class="dd pd">SQL expression. Must be * if operation is LEVEL or IS_CYCLE.</dd><dt class="dt pt dlterm"><var class="keyword varname">alias</var></dt><dd class="dd pd">Name of the output table column that contains the result of the operation.</dd><dd class="dd pd ddexpand">The function ignores <var class="keyword varname">alias</var> if it is the same as an input table column name.</dd><dd class="dd pd ddexpand">Default: The string <code class="ph codeph"><var class="keyword varname">operation</var>(<var class="keyword varname">expression</var>)</code>; for example, <code class="ph codeph">PATH(<var class="keyword varname">node_name</var>)</code></dd></dl></dd></dl></div></div></div></div></body></html>
