<div class="nested0" aria-labelledby="ariaid-title1" topicindex="1" topicid="orc1572294577957" id="orc1572294577957"><h1 class="title topictitle1" id="ariaid-title1">GLMPredictPerSegment</h1><div class="body conbody">
<p class="p">The GLMPredictPerSegment function uses the model output by the function <a href="vzk1572296570258.md#vzk1572296570258">GLMPerSegment</a> to perform generalized linear model prediction on new input data.</p></div><div class="topic reference nested1" aria-labelledby="ariaid-title2" topicindex="2" topicid="vdg1572294604802" xml:lang="en-us" lang="en-us" id="vdg1572294604802">
<h2 class="title topictitle2" id="ariaid-title2">GLMPredictPerSegment Syntax</h2><div class="body refbody"><div class="section" id="vdg1572294604802__section_N10025_N10022_N10001">
<h3 class="title sectiontitle">Version ?</h3><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM GLMPredictPerSegment (
  <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> 
    PARTITION BY { <var class="keyword varname">partition_column</var> [, ...] | 1 }
  <span>ON { <var class="keyword varname">table</var> | <var class="keyword varname">view</var> | (<var class="keyword varname">query</var>) }</span> AS Model
    PARTITION BY { <var class="keyword varname">partition_column</var> [, ...] | 1 }
  USING
  [ OutputProb (<span><b>{'true'|'t'|'yes'|'y'|'1'|'false'|'f'|'no'|'n'|'0'}</b></span>) ]
  [ Responses ('<var class="keyword varname">response</var>' [,...]) ]
  <code class="ph codeph">[ Accumulate ({ '<var class="keyword varname">accumulate_column</var>' | <var class="keyword varname">accumulate_column_range</var> }[,...]) ]</code>
);
</code></pre></div></div><div class="related-links"><div class="linklistheader"><p></p><b>Related Information</b></div>
<ul class="linklist linklist"><div class="linklistmember"><a href="eta1543514041091.md">Comments in Queries</a></div><div class="linklistmember"><a href="ndv1557782188375.md">Column Specification Syntax Elements</a></div></ul></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title3" topicindex="3" topicid="dmf1572295147839" xml:lang="en-us" lang="en-us" id="dmf1572295147839">
<h2 class="title topictitle2" id="ariaid-title3">GLMPredictPerSegment Syntax Elements</h2><div class="body refbody"><div class="section" id="dmf1572295147839__section_N10011_N1000E_N10001"><dl class="dl parml"><dt class="dt pt dlterm">OutputProb</dt><dd class="dd pd">[Optional] Specify whether to output calculated probability for each observation.</dd><dd class="dd pd ddexpand">Default: 'false'</dd><dt class="dt pt dlterm">Responses</dt><dd class="dd pd">[Optional with OutputProb ('true'), disallowed otherwise.] Specify the labels for which to output probabilities. A label (<var class="keyword varname">response</var>) must be 0, 1, or both 0 and 1.</dd><dd class="dd pd ddexpand">Default behavior: The function outputs only the probability of the predicted class.</dd><dt class="dt pt dlterm">Accumulate</dt><dd class="dd pd">[Optional] Specify the names of input table columns to copy to the output table.</dd></dl></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title4" topicindex="4" topicid="bqj1572295686395" xml:lang="en-us" lang="en-us" id="bqj1572295686395">
<h2 class="title topictitle2" id="ariaid-title4">GLMPredictPerSegment Input</h2><div class="body refbody"><div class="section" id="bqj1572295686395__section_N1000E_N1000C_N10001"><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="bqj1572295686395__table_cqq_dqv_xcb" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d83165e198" rowspan="1" colspan="1">Table</th><th class="entry cellrowborder" style="vertical-align:top;" id="d83165e200" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e198" rowspan="1" colspan="1">Input</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e200" rowspan="1" colspan="1">Contains new data.</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e198" rowspan="1" colspan="1">Model</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e200" rowspan="1" colspan="1"><a href="vzk1572296570258.md#xag1572296661289">GLMPerSegment Output</a></td></tr></tbody></table></div></div><div class="section" id="bqj1572295686395__section_s4l_brv_xcb">
<h3 class="title sectiontitle">Input Table Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="bqj1572295686395__table_N10021_N10019_N10014_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:28.57142857142857%" span="1"></col><col style="width:14.285714285714285%" span="1"></col><col style="width:57.14285714285714%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d83165e225" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d83165e227" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d83165e229" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e225" rowspan="1" colspan="1"><var class="keyword varname">partition_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e227" rowspan="1" colspan="1">Any</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d83165e229" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">partition_column</var>.] Column by which input table is partitioned.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e225" rowspan="1" colspan="1"><var class="keyword varname">numeric_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e227" rowspan="1" colspan="1"><span>Any numeric SQL data type</span></td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d83165e229" rowspan="1" colspan="1">[Column appears one or more times.] Independent/predictor variable.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d83165e225" rowspan="1" colspan="1"><var class="keyword varname">categorical_column</var></td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d83165e227" rowspan="1" colspan="1">Any</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e229" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">categorical_column</var>.] Categorical independent/predictor variable.</td></tr></tbody></table></div></div></div></div><div class="topic reference nested1" aria-labelledby="ariaid-title5" topicindex="5" topicid="qaw1572295706321" xml:lang="en-us" lang="en-us" id="qaw1572295706321">
<h2 class="title topictitle2" id="ariaid-title5">GLMPredictPerSegment Output</h2><div class="body refbody"><div class="section" id="qaw1572295706321__section_mnp_djv_xcb">
<h3 class="title sectiontitle">Output Table Schema</h3><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="qaw1572295706321__table_N1000E_N1000C_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:28.57142857142857%" span="1"></col><col style="width:14.285714285714285%" span="1"></col><col style="width:57.14285714285714%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d83165e286" rowspan="1" colspan="1">Column</th><th class="entry nocellnorowborder" style="vertical-align:top;" id="d83165e288" rowspan="1" colspan="1">Data Type</th><th class="entry cell-norowborder" style="vertical-align:top;" id="d83165e290" rowspan="1" colspan="1">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e286" rowspan="1" colspan="1"><var class="keyword varname">accumulate_column</var></td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e288" rowspan="1" colspan="1"><span>Same as in input table</span></td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d83165e290" rowspan="1" colspan="1">[Column appears once for each specified <var class="keyword varname">accumulate_column</var>.] <span>Column copied from input table.</span></td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e286" rowspan="1" colspan="1">prediction</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e288" rowspan="1" colspan="1">VARCHAR</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d83165e290" rowspan="1" colspan="1">Predicted value. 0 or 1 for Family ('BINOMIAL'), numerical value for Family ('GAUSSIAN').</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e286" rowspan="1" colspan="1">prob</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e288" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d83165e290" rowspan="1" colspan="1">[Column appears only if you specify OutputProb ('true') and omit Responses.] For Family ('BINOMIAL'), probability that observation belongs to class in prediction column.<div class="note note" id="qaw1572295706321__note_N1009C_N10099_N10090_N10050_N10028_N10021_N10014_N10010_N10001"><span><b>Note</b></span><div class="notebody">If GLMPerSegment call that created model specified Family ('GAUSSIAN'), all values in this column are NULL.</div></div></td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e286" rowspan="1" colspan="1">prob_0</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e288" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d83165e290" rowspan="1" colspan="1">[Column appears only with Responses.] Probability that observation belongs to category 0.</td></tr><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e286" rowspan="1" colspan="1">prob_1</td><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d83165e288" rowspan="1" colspan="1">DOUBLE PRECISION</td><td class="entry cell-norowborder" style="vertical-align:top;" headers="d83165e290" rowspan="1" colspan="1">[Column appears only with Responses.] Probability that observation belongs to category 1.</td></tr><tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d83165e286" rowspan="1" colspan="1">error_code</td><td class="entry row-nocellborder" style="vertical-align:top;" headers="d83165e288" rowspan="1" colspan="1">VARCHAR</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e290" rowspan="1" colspan="1">Error code if function could not make prediction:<div class="p"><div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="qaw1572295706321__table_N100F4_N100F2_N100EE_N100E4_N10045_N1001D_N10019_N10011_N1000E_N10001" class="table" frame="border" border="1" rules="all"><div class="caption"></div><colgroup span="1"><col style="width:50%" span="1"></col><col style="width:50%" span="1"></col></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:top;" id="d83165e351" rowspan="1" colspan="1">Error Code</th><th class="entry cellrowborder" style="vertical-align:top;" id="d83165e353" rowspan="1" colspan="1">Meaning</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e351" rowspan="1" colspan="1">1</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e353" rowspan="1" colspan="1">Invalid model</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e351" rowspan="1" colspan="1">2</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e353" rowspan="1" colspan="1">Model is not in ModelTable</td></tr><tr class="row"><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e351" rowspan="1" colspan="1">3</td><td class="entry cellrowborder" style="vertical-align:top;" headers="d83165e353" rowspan="1" colspan="1">Invalid input table row</td></tr></tbody></table></div></div></td></tr></tbody></table></div></div></div></div><div class="topic concept nested1" aria-labelledby="ariaid-title6" topicindex="6" topicid="jlt1572295804498" xml:lang="en-us" lang="en-us" id="jlt1572295804498">
<h2 class="title topictitle2" id="ariaid-title6">GLMPredictPerSegment Examples</h2><div class="topic reference nested2" aria-labelledby="ariaid-title7" topicindex="7" topicid="lml1572295833901" xml:lang="en-us" lang="en-us" id="lml1572295833901">
<h3 class="title topictitle3" id="ariaid-title7">GLMPredictPerSegment Example: Regression, Family ('GAUSSIAN')</h3><div class="body refbody"><div class="section" id="lml1572295833901__section_N10011_N1000E_N10001">
<h4 class="title sectiontitle">Input</h4>
<ul class="ul">
<li class="li">housing_test, as in <a href="zyz1541530923856.md">GLMPredict_MLE Example: Gaussian Distribution Prediction</a></li>
<li class="li">glm_ps_housing_1, output by <a href="vzk1572296570258.md#gmz1572296697203">GLMPerSegment Example: Regression, Family ('GAUSSIAN')</a></li></ul></div><div class="section" id="lml1572295833901__section_qhy_1kz_m2b">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM GLMPredictPerSegment (
  ON housing_test PARTITION BY homestyle
  ON glm_ps_housing_1 AS Model PARTITION BY homestyle
  USING
  Accumulate ('sn','homestyle','price') 
) AS dt ORDER BY sn;
</code></pre></div><div class="section" id="lml1572295833901__section_spg_ckz_m2b">
<h4 class="title sectiontitle">Output</h4><pre class="pre screen" xml:space="preserve">sn  homestyle price    prediction         error_code 
--- --------- -------- ------------------ ---------- 
 13 classic    27000.0 41792.71049452186  NULL      
 16 classic    37900.0 42911.6990886487   NULL      
 25 classic    42000.0 39637.52745046294  NULL      
 38 eclectic   67000.0 78544.34514033666  NULL      
 53 eclectic   68000.0 65694.99777783247  NULL      
104 bungalow  132000.0 126874.4187852145  NULL      
111 classic    43000.0 39226.68979829896  NULL      
117 eclectic   93000.0 68270.04132155296  NULL      
132 classic    44500.0 41793.94508180405  NULL     
 ...
</pre></div><div class="section" id="lml1572295833901__section_N10644_N10023_N10001">
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div><div class="topic reference nested2" aria-labelledby="ariaid-title8" topicindex="8" topicid="wdx1572295879994" xml:lang="en-us" lang="en-us" id="wdx1572295879994">
<h3 class="title topictitle3" id="ariaid-title8">GLMPredictPerSegment Example: Regression, AttributeTable, ParameterTable</h3><div class="body refbody"><div class="section" id="wdx1572295879994__section_N10018_N1000E_N10001">
<h4 class="title sectiontitle">Input</h4>
<ul class="ul">
<li class="li">housing_test, as in <a href="zyz1541530923856.md">GLMPredict_MLE Example: Gaussian Distribution Prediction</a></li>
<li class="li">glm_ps_housing_2, output by <a href="vzk1572296570258.md#btn1572296714020">GLMPerSegment Example: Regression, AttributeTable, ParameterTable</a></li></ul></div><div class="section" id="wdx1572295879994__section_ljr_jqc_4db">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM GLMPredictPerSegment (
  ON housing_test PARTITION BY homestyle
  ON glm_ps_housing_2 AS Model PARTITION BY homestyle
  USING
  Accumulate ('sn','homestyle','price') 
) AS dt ORDER BY sn;
</code></pre></div><div class="section" id="wdx1572295879994__section_i4h_kqc_4db">
<h4 class="title sectiontitle">Output</h4><pre class="pre screen" xml:space="preserve">sn  homestyle price    prediction         error_code 
--- --------- -------- ------------------ ---------- 
 13 classic    27000.0 28121.93106958178  NULL      
 16 classic    37900.0 28122.524114897366 NULL      
 25 classic    42000.0 28123.232973776263 NULL      
 38 eclectic   67000.0 73138.03412830898  NULL      
 53 eclectic   68000.0 73903.82922281937  NULL      
104 bungalow  132000.0 20868.46290303957  NULL      
111 classic    43000.0 28123.27929920159  NULL  
...
</pre></div><div class="section" id="wdx1572295879994__section_N10491_N10023_N10001">
<p class="p">Download a zip file of all examples and a SQL script file that creates their input tables from the attachment in the left sidebar.</p></div></div></div><div class="topic reference nested2" aria-labelledby="ariaid-title9" topicindex="9" topicid="moz1572899810447" xml:lang="en-us" lang="en-us" id="moz1572899810447">
<h3 class="title topictitle3" id="ariaid-title9">GLMPredictPerSegment Example: Logistic Regression, Family ('BINOMIAL')</h3><div class="body refbody"><div class="section" id="moz1572899810447__section_N10025_N10022_N10001">
<h4 class="title sectiontitle">Input</h4>
<ul class="ul">
<li class="li">admissions_test, as in <a href="jnw1541530854319.md">GLMPredict_MLE Example: Logistic Distribution Prediction</a></li>
<li class="li">glm_ps_admission, output by <a href="vzk1572296570258.md#otd1572896246305">GLMPerSegment Example: Logical Regression, Family ('BINOMIAL')</a></li></ul></div><div class="section" id="moz1572899810447__section_N1003A_N10022_N10001">
<h4 class="title sectiontitle">SQL Call</h4><pre class="pre codeblock" xml:space="preserve"><code>SELECT * FROM GLMPredictPerSegment (
  ON admissions_test PARTITION BY masters
  ON glm_ps_admission AS Model PARTITION BY masters
  USING
  Accumulate ('id','masters','admitted') 
  OutputProb ('t')
) AS dt ORDER BY id;
</code></pre></div><div class="section" id="moz1572899810447__section_N10044_N10022_N10001">
<h4 class="title sectiontitle">Output</h4><pre class="pre screen" xml:space="preserve">id masters admitted prediction prob               error_code 
-- ------- -------- ---------- ------------------ ---------- 
50 yes            0 0          0.7557199737086269 NULL      
51 yes            0 0          0.7383527456399348 NULL      
52 no             1 1           0.999925036619523 NULL      
53 yes            1 1          0.8099636753722493 NULL      
54 yes            1 1          0.6860262600792199 NULL      
55 no             1 1          0.9997294677346087 NULL      
...
</pre></div></div></div></div></div>
